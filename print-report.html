<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ì²´ ë³´ê³ ì„œ ì¸ì‡„ - Prefab í’ˆì§ˆê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        /* ì¸ì‡„ ì „ìš© ìŠ¤íƒ€ì¼ */
        @media print {
            @page {
                size: A4 portrait;
                margin: 15mm;
            }
            
            html {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            body {
                margin: 0;
                padding: 0;
            }
            
            .no-print {
                display: none !important;
            }
            
            .page-break {
                page-break-after: always;
                break-after: page;
            }
            
            .card {
                page-break-inside: avoid;
                break-inside: avoid;
                margin-bottom: 0.5rem;
            }
            
            .photo-grid img {
                max-width: 100% !important;
                height: auto !important;
                object-fit: contain !important;
            }
            
            table {
                font-size: 10pt;
                width: 100%;
            }
            
            th, td {
                padding: 0.4rem;
            }
        }
        
        /* í™”ë©´ í‘œì‹œìš© ìŠ¤íƒ€ì¼ */
        .report-section {
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.75rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-color);
        }
        
        .print-header {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            margin-bottom: 2rem;
        }
        
        .print-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .print-button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 1rem;
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .print-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            width: 100%;
            margin-bottom: 0.5rem;
        }
        
        .print-button:hover {
            background: var(--secondary-color);
        }
        
        .back-button {
            background: #6b7280;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 0.95rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            width: 100%;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .photo-grid img {
            width: 100%;
            height: auto;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
        }
    </style>
    <script src="assets/js/script.js"></script>
</head>
<body>
    <!-- ì¸ì‡„ ë²„íŠ¼ -->
    <div class="print-button-container no-print">
        <button class="print-button" onclick="window.print()">ğŸ–¨ï¸ ì „ì²´ ë³´ê³ ì„œ ì¸ì‡„</button>
        <button class="back-button" onclick="window.location.href='dashboard.html'">â† ëŒ€ì‹œë³´ë“œë¡œ</button>
        
        <div style="margin-top: 1rem; padding: 1rem; background: #fff3cd; border: 1px solid #ffc107; border-radius: 5px; font-size: 0.875rem;">
            <strong>ğŸ’¡ ì¸ì‡„ ì•ˆë‚´:</strong><br>
            ì¸ì‡„ ëŒ€í™”ìƒìì—ì„œ <strong>"í—¤ë” ë° í‘¸í„°"</strong>ë¥¼ ë„ê³ ,<br>
            <strong>"ë°°ê²½ ê·¸ë˜í”½"</strong>ì„ ì¼œì£¼ì„¸ìš”.
        </div>
    </div>

    <!-- ë³´ê³ ì„œ í—¤ë” -->
    <div class="print-header">
        <h1>Prefab í’ˆì§ˆê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
        <div class="subtitle">ì „ì²´ í’ˆì§ˆê´€ë¦¬ ë³´ê³ ì„œ</div>
    </div>

    <div class="container">
        <!-- 1. í”„ë¡œì íŠ¸ ì •ë³´ -->
        <div class="report-section page-break">
            <h2 class="section-title">1. í”„ë¡œì íŠ¸ ì •ë³´</h2>
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ê¸°ë³¸ ì •ë³´</h3>
                </div>
                <div class="card-body">
                    <div class="info-grid" id="projectInfo">
                        <div class="info-item">
                            <label class="info-label">ê³µì‚¬ëª…</label>
                            <div class="info-value" id="projectName">-</div>
                        </div>
                        <div class="info-item">
                            <label class="info-label">ì ê²€ì¼</label>
                            <div class="info-value" id="inspectionDate">-</div>
                        </div>
                        <div class="info-item">
                            <label class="info-label">Prefab ì¢…ë¥˜</label>
                            <div class="info-value" id="prefabType">-</div>
                        </div>
                        <div class="info-item">
                            <label class="info-label">ì„¤ì¹˜ ìœ„ì¹˜</label>
                            <div class="info-value" id="location">-</div>
                        </div>
                        <div class="info-item">
                            <label class="info-label">ì ê²€ì</label>
                            <div class="info-value" id="inspector">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸ -->
        <div class="report-section page-break">
            <h2 class="section-title">2. ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸</h2>
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ì ê²€ í•­ëª©</h3>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>í‰ê°€ í•­ëª©</th>
                                <th>ì¸¡ì • ê²°ê³¼</th>
                                <th>í—ˆìš© ê¸°ì¤€</th>
                                <th>íŒì •</th>
                                <th>ë¹„ê³ </th>
                            </tr>
                        </thead>
                        <tbody id="surveyTable">
                            <tr><td colspan="5" style="text-align: center;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;">
                <div class="card-header">
                    <h3 class="card-title">í˜„ì¥ ì‚¬ì§„</h3>
                </div>
                <div class="card-body">
                    <div class="photo-grid" id="surveyPhotos">
                        <p style="text-align: center; color: #6b7280;">ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. ê°€ì†ë„ ë°ì´í„° -->
        <div class="report-section page-break">
            <h2 class="section-title">3. ê°€ì†ë„ ë°ì´í„°</h2>
            
            <div class="alert alert-info" style="margin-bottom: 1rem;">
                <strong>ğŸ“Š í‰ê°€ ê¸°ì¤€ (KCS ê¸°ì¤€)</strong><br>
                ì •ìƒ: &lt;0.20g | ì£¼ì˜: 0.20~0.30g | ê²½ê³ : 0.30~0.40g | ìœ„í—˜: &gt;0.40g
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ì¸¡ì • ê²°ê³¼</h3>
                </div>
                <div class="card-body">
                    <div class="stats-grid" id="accelStats">
                        <div class="stat-card">
                            <div class="stat-label">ìµœëŒ€ ê°€ì†ë„</div>
                            <div class="stat-value" id="maxAccel">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">í‰ê·  ê°€ì†ë„</div>
                            <div class="stat-value" id="avgAccel">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì´ë²¤íŠ¸ íšŸìˆ˜</div>
                            <div class="stat-value" id="accelEvents">-</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ì¸¡ì • ë°ì´í„° í…Œì´ë¸”ì€ ì‹¤ì œ ì¸¡ì • ë°°ì—´ì´ ì—†ìœ¼ë¯€ë¡œ í‘œì‹œí•˜ì§€ ì•ŠìŒ -->
            
            <div class="card" style="margin-top: 1rem;" id="accelReportCard">
                <div class="card-header">
                    <h3 class="card-title">ë“±ê¸‰ í‰ê°€ ë¦¬í¬íŠ¸</h3>
                </div>
                <div class="card-body" id="accelReportImage">
                    <p style="text-align: center; color: #6b7280;">ë¦¬í¬íŠ¸ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;" id="accelGraphCard">
                <div class="card-header">
                    <h3 class="card-title">ì „ì²´ ê°€ì†ë„ ê·¸ë˜í”„</h3>
                </div>
                <div class="card-body" id="accelGraphImage">
                    <p style="text-align: center; color: #6b7280;">ê·¸ë˜í”„ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <!-- 4. ê¸°ìš¸ê¸° ë°ì´í„° -->
        <div class="report-section page-break">
            <h2 class="section-title">4. ê¸°ìš¸ê¸° ë°ì´í„°</h2>
            
            <div class="alert alert-info" style="margin-bottom: 1rem;">
                <strong>ğŸ“ í‰ê°€ ê¸°ì¤€ (KCS ê¸°ì¤€)</strong><br>
                ì •ìƒ: &lt;3Â° | ì£¼ì˜: 3~5Â° | ê²½ê³ : 5~10Â° | ìœ„í—˜: &gt;10Â°
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ì¸¡ì • ê²°ê³¼</h3>
                </div>
                <div class="card-body">
                    <div class="stats-grid" id="tiltStats">
                        <div class="stat-card">
                            <div class="stat-label">ìµœëŒ€ ê¸°ìš¸ê¸°</div>
                            <div class="stat-value" id="maxTilt">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">í‰ê·  ê¸°ìš¸ê¸°</div>
                            <div class="stat-value" id="avgTilt">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì´ë²¤íŠ¸ íšŸìˆ˜</div>
                            <div class="stat-value" id="tiltEvents">-</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ì¸¡ì • ë°ì´í„° í…Œì´ë¸”ì€ ì‹¤ì œ ì¸¡ì • ë°°ì—´ì´ ì—†ìœ¼ë¯€ë¡œ í‘œì‹œí•˜ì§€ ì•ŠìŒ -->
            
            <div class="card" style="margin-top: 1rem;" id="tiltReportCard">
                <div class="card-header">
                    <h3 class="card-title">ë“±ê¸‰ í‰ê°€ ë¦¬í¬íŠ¸</h3>
                </div>
                <div class="card-body" id="tiltReportImage">
                    <p style="text-align: center; color: #6b7280;">ë¦¬í¬íŠ¸ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;" id="tiltGraphCard">
                <div class="card-header">
                    <h3 class="card-title">ì „ì²´ ê¸°ìš¸ê¸° ê·¸ë˜í”„</h3>
                </div>
                <div class="card-body" id="tiltGraphImage">
                    <p style="text-align: center; color: #6b7280;">ê·¸ë˜í”„ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;" id="tiltAdjustmentCard">
                <div class="card-header">
                    <h3 class="card-title">ê¸°ìš¸ê¸° ì¡°ì • ì´ë ¥</h3>
                </div>
                <div class="card-body" id="tiltAdjustmentHistory">
                    <p style="color: #6b7280;">ì¡°ì • ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <!-- 5. ë³€í˜•ë¥  ë°ì´í„° -->
        <div class="report-section page-break">
            <h2 class="section-title">5. ë³€í˜•ë¥  ë°ì´í„°</h2>
            
            <div class="alert alert-info" style="margin-bottom: 1rem;">
                <strong>ğŸ“ í‰ê°€ ê¸°ì¤€ (KCS ê¸°ì¤€)</strong><br>
                ì •ìƒ: &lt;60Î¼Îµ | ì£¼ì˜: 60~80Î¼Îµ | ê²½ê³ : 80~130Î¼Îµ | ìœ„í—˜: &gt;130Î¼Îµ
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ì¸¡ì • ê²°ê³¼</h3>
                </div>
                <div class="card-body">
                    <div class="stats-grid" id="strainStats">
                        <div class="stat-card">
                            <div class="stat-label">ìµœëŒ€ ë³€í˜•ë¥ </div>
                            <div class="stat-value" id="maxStrain">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">í‰ê·  ë³€í˜•ë¥ </div>
                            <div class="stat-value" id="avgStrain">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì´ë²¤íŠ¸ íšŸìˆ˜</div>
                            <div class="stat-value" id="strainEvents">-</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ì¸¡ì • ë°ì´í„° í…Œì´ë¸”ì€ ì‹¤ì œ ì¸¡ì • ë°°ì—´ì´ ì—†ìœ¼ë¯€ë¡œ í‘œì‹œí•˜ì§€ ì•ŠìŒ -->
            
            <div class="card" style="margin-top: 1rem;" id="strainReportCard">
                <div class="card-header">
                    <h3 class="card-title">ë“±ê¸‰ í‰ê°€ ë¦¬í¬íŠ¸</h3>
                </div>
                <div class="card-body" id="strainReportImage">
                    <p style="text-align: center; color: #6b7280;">ë¦¬í¬íŠ¸ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;" id="strainGraphCard">
                <div class="card-header">
                    <h3 class="card-title">ì „ì²´ ë³€í˜•ë¥  ê·¸ë˜í”„</h3>
                </div>
                <div class="card-body" id="strainGraphImage">
                    <p style="text-align: center; color: #6b7280;">ê·¸ë˜í”„ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <!-- 6. ë¶€ì¬ ì œì‘ ì˜¤ì°¨ -->
        <div class="report-section page-break">
            <h2 class="section-title">6. ë¶€ì¬ ì œì‘ ì˜¤ì°¨</h2>
            
            <div class="alert alert-info" style="margin-bottom: 1rem;">
                <strong>ğŸ“ í—ˆìš© ì˜¤ì°¨ ê¸°ì¤€ (KCS)</strong><br>
                íŒ¨ë„ ê¸¸ì´/í­: Â±min(1%, 30mm) | íŒ¨ë„ ë‘ê»˜: +10mm ~ -5mm
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ì¸¡ì • ë°ì´í„°</h3>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>ì¸¡ì • í•­ëª©</th>
                                <th>ì„¤ê³„ê°’ (mm)</th>
                                <th>ì‹¤ì¸¡ê°’ (mm)</th>
                                <th>ì˜¤ì°¨ (mm)</th>
                                <th>í—ˆìš©ì˜¤ì°¨</th>
                                <th>íŒì •</th>
                            </tr>
                        </thead>
                        <tbody id="errorTable">
                            <tr><td colspan="6" style="text-align: center;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;" id="errorPhotosCard">
                <div class="card-header">
                    <h3 class="card-title">ë¶€ì¬ ì‚¬ì§„</h3>
                </div>
                <div class="card-body">
                    <div class="photo-grid" id="errorPhotos">
                        <p style="text-align: center; color: #6b7280;">ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 7. ì¢…í•© ëŒ€ì‹œë³´ë“œ -->
        <div class="report-section">
            <h2 class="section-title">7. ì¢…í•© ëŒ€ì‹œë³´ë“œ</h2>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">ì¢…í•© í’ˆì§ˆ í‰ê°€</h2>
                </div>
                <div class="card-body">
                    <div class="stats-grid" id="overallStats">
                        <div class="stat-card" id="overallCard">
                            <div class="stat-label">ì¢…í•© í‰ê°€</div>
                            <div class="stat-value">í‰ê°€ì¤‘</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ê²€ì‚¬ í•­ëª©</div>
                            <div class="stat-value" id="totalItems">-</div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-label">í•©ê²© í•­ëª©</div>
                            <div class="stat-value" id="passedItems">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ë¶ˆí•©ê²© í•­ëª©</div>
                            <div class="stat-value" id="failedItems">-</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;">
                <div class="card-header">
                    <h2 class="card-title">ìƒì„¸ í‰ê°€ ê²°ê³¼</h2>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>í‰ê°€ í•­ëª©</th>
                                <th>ì¸¡ì • ê²°ê³¼</th>
                                <th>í—ˆìš© ê¸°ì¤€</th>
                                <th>íŒì •</th>
                                <th>ë¹„ê³ </th>
                            </tr>
                        </thead>
                        <tbody id="detailTable">
                            <tr><td colspan="5" style="text-align: center;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;">
                <div class="card-header">
                    <h2 class="card-title">ì£¼ìš” ì´ìŠˆ ë° ê¶Œê³ ì‚¬í•­</h2>
                </div>
                <div class="card-body" id="issuesContainer">
                    <p style="text-align: center; color: var(--success-color); font-weight: 600;">âœ… ì£¼ìš” ì´ìŠˆ ì—†ìŒ</p>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1rem;">
                <div class="card-header">
                    <h2 class="card-title">ìµœì¢… í’ˆì§ˆ íŒì •</h2>
                </div>
                <div class="card-body">
                    <div class="alert" id="finalJudgment" style="text-align: center; padding: 2rem; font-size: 1.25rem;">
                        â³ í‰ê°€ ëŒ€ê¸°ì¤‘
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“„ ì „ì²´ ë³´ê³ ì„œ ë¡œë“œ ì‹œì‘');
            loadAllData();
        });

        function loadAllData() {
            // 1. í”„ë¡œì íŠ¸ ì •ë³´
            loadProjectInfo();
            
            // 2. ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸
            loadSurveyData();
            
            // 3. ê°€ì†ë„ ë°ì´í„°
            loadAccelData();
            
            // 4. ê¸°ìš¸ê¸° ë°ì´í„°
            loadTiltData();
            
            // 5. ë³€í˜•ë¥  ë°ì´í„°
            loadStrainData();
            
            // 6. ë¶€ì¬ ì œì‘ ì˜¤ì°¨
            loadErrorData();
            
            // 7. ì¢…í•© ëŒ€ì‹œë³´ë“œ (ëª¨ë“  ë°ì´í„° ë¡œë“œ í›„)
            setTimeout(() => {
                loadDashboard();
            }, 500);
        }

        function loadProjectInfo() {
            const projectData = getFromStorage(STORAGE_KEYS.PROJECT_INFO);
            if (projectData) {
                document.getElementById('projectName').textContent = projectData.projectName || '-';
                document.getElementById('inspectionDate').textContent = projectData.inspectionDate || '-';
                document.getElementById('prefabType').textContent = projectData.prefabType || '-';
                document.getElementById('location').textContent = projectData.location || '-';
                document.getElementById('inspector').textContent = projectData.inspector || '-';
            }
        }

        function loadSurveyData() {
            const surveyData = getFromStorage(STORAGE_KEYS.SURVEY_DATA);
            const photos = getFromStorage(STORAGE_KEYS.PHOTOS);
            
            if (surveyData) {
                // í‰ê°€ ë¡œì§ (dashboard.htmlê³¼ ë™ì¼)
                const q1Pass = surveyData.q1 === 'ìˆ˜ë ¹';
                const q2Pass = surveyData.q2 === 'ì†ìƒì—†ìŒ' || surveyData.q2 === 'ì—†ìŒ';
                const q3Pass = surveyData.q3 === 'ì–‘í˜¸';
                const q4Pass = surveyData.q4 === 'ì •ìƒ' || surveyData.q4 === 'ì—†ìŒ';
                const q5Pass = surveyData.q5 === 'ì ì¹˜ë¨' || surveyData.q5 === 'ì ì¹˜ì™„ë£Œ';
                
                let html = '';
                
                // Q1
                html += `<tr>
                    <td>í’ˆì§ˆë³´ì¦ì„œ ìˆ˜ë ¹</td>
                    <td>${surveyData.q1 || '-'}</td>
                    <td>ìˆ˜ë ¹ í•„ìˆ˜</td>
                    <td><span class="badge ${q1Pass ? 'badge-success' : 'badge-danger'}">${q1Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td>
                    <td>${q1Pass ? '-' : 'í’ˆì§ˆë³´ì¦ì„œ ë¯¸ìˆ˜ë ¹'}</td>
                </tr>`;
                
                // Q2
                html += `<tr>
                    <td>ìŠ¬ë˜ë¸Œ ì†ìƒ/ê· ì—´</td>
                    <td>${surveyData.q2 || '-'}</td>
                    <td>ì†ìƒì—†ìŒ ë˜ëŠ” ì—†ìŒ</td>
                    <td><span class="badge ${q2Pass ? 'badge-success' : 'badge-danger'}">${q2Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td>
                    <td>${q2Pass ? '-' : 'ìŠ¬ë˜ë¸Œì— ì†ìƒ ë˜ëŠ” ê· ì—´ ë°œê²¬'}</td>
                </tr>`;
                
                // Q3
                html += `<tr>
                    <td>ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°©ìƒíƒœ</td>
                    <td>${surveyData.q3 || '-'}</td>
                    <td>ì–‘í˜¸</td>
                    <td><span class="badge ${q3Pass ? 'badge-success' : 'badge-danger'}">${q3Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td>
                    <td>${q3Pass ? '-' : 'ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°© ë¶ˆëŸ‰'}</td>
                </tr>`;
                
                // Q4
                html += `<tr>
                    <td>ì™€ì´ì–´/ìŠ¬ë§ë²¨íŠ¸ ê²°í•¨</td>
                    <td>${surveyData.q4 || '-'}</td>
                    <td>ì •ìƒ ë˜ëŠ” ì—†ìŒ</td>
                    <td><span class="badge ${q4Pass ? 'badge-success' : 'badge-danger'}">${q4Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td>
                    <td>${q4Pass ? '-' : 'ì™€ì´ì–´ ë˜ëŠ” ìŠ¬ë§ë²¨íŠ¸ì— ê²°í•¨ ë°œê²¬'}</td>
                </tr>`;
                
                // Q5
                html += `<tr>
                    <td>ìŠ¬ë˜ë¸Œ ì ì¹˜</td>
                    <td>${surveyData.q5 || '-'}</td>
                    <td>ì ì¹˜ë¨ ë˜ëŠ” ì ì¹˜ì™„ë£Œ</td>
                    <td><span class="badge ${q5Pass ? 'badge-success' : 'badge-danger'}">${q5Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td>
                    <td>${q5Pass ? '-' : 'ìŠ¬ë˜ë¸Œ ë¯¸ì ì¹˜'}</td>
                </tr>`;
                
                document.getElementById('surveyTable').innerHTML = html;
            }
            
            // í˜„ì¥ ì‚¬ì§„ ë¡œë“œ
            if (photos) {
                let photoHTML = '';
                for (let i = 1; i <= 4; i++) {
                    const photoKey = `photo${i}Preview`;
                    if (photos[photoKey]) {
                        photoHTML += `<img src="${photos[photoKey]}" alt="í˜„ì¥ì‚¬ì§„ ${i}">`;
                    }
                }
                if (photoHTML) {
                    document.getElementById('surveyPhotos').innerHTML = photoHTML;
                }
            }
        }

        function loadAccelData() {
            const accelData = getFromStorage(STORAGE_KEYS.ACCELERATION_DATA);
            
            if (accelData) {
                // í†µê³„ ì •ë³´
                document.getElementById('maxAccel').textContent = (accelData.maxAcceleration || '-') + ' g';
                document.getElementById('avgAccel').textContent = (accelData.avgAcceleration || '-') + ' g';
                document.getElementById('accelEvents').textContent = (accelData.eventCount || '-') + ' íšŒ';
                
                // ê°œë³„ í˜ì´ì§€ëŠ” measurements ë°°ì—´ì„ ì €ì¥í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ í…Œì´ë¸” ìƒëµ
                
                // ë¦¬í¬íŠ¸ ì´ë¯¸ì§€
                const reportImage = getFromStorage(STORAGE_KEYS.ACCEL_REPORT_IMAGE);
                if (reportImage) {
                    document.getElementById('accelReportImage').innerHTML = `<img src="${reportImage}" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;">`;
                } else {
                    document.getElementById('accelReportCard').style.display = 'none';
                }
                
                // ì „ì²´ ê°€ì†ë„ ê·¸ë˜í”„ ì´ë¯¸ì§€
                const graphImage = getFromStorage(STORAGE_KEYS.ACCEL_GRAPH_IMAGE);
                if (graphImage) {
                    document.getElementById('accelGraphImage').innerHTML = `<img src="${graphImage}" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;">`;
                } else {
                    document.getElementById('accelGraphCard').style.display = 'none';
                }
            }
        }

        function loadTiltData() {
            const tiltData = getFromStorage(STORAGE_KEYS.TILT_DATA);
            
            if (tiltData) {
                // í†µê³„ ì •ë³´
                document.getElementById('maxTilt').textContent = (tiltData.maxTilt || '-') + ' Â°';
                document.getElementById('avgTilt').textContent = (tiltData.avgTilt || '-') + ' Â°';
                document.getElementById('tiltEvents').textContent = (tiltData.eventCount || '-') + ' íšŒ';
                
                // ê°œë³„ í˜ì´ì§€ëŠ” measurements ë°°ì—´ì„ ì €ì¥í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ í…Œì´ë¸” ìƒëµ
                
                // ë¦¬í¬íŠ¸ ì´ë¯¸ì§€
                const reportImage = getFromStorage(STORAGE_KEYS.TILT_REPORT_IMAGE);
                if (reportImage) {
                    document.getElementById('tiltReportImage').innerHTML = `<img src="${reportImage}" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;">`;
                } else {
                    document.getElementById('tiltReportCard').style.display = 'none';
                }
                
                // ì „ì²´ ê¸°ìš¸ê¸° ê·¸ë˜í”„ ì´ë¯¸ì§€
                const graphImage = getFromStorage(STORAGE_KEYS.TILT_GRAPH_IMAGE);
                if (graphImage) {
                    document.getElementById('tiltGraphImage').innerHTML = `<img src="${graphImage}" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;">`;
                } else {
                    document.getElementById('tiltGraphCard').style.display = 'none';
                }
                
                // ê¸°ìš¸ê¸° ì¡°ì • ì´ë ¥
                if (tiltData.adjustmentHistory) {
                    document.getElementById('tiltAdjustmentHistory').innerHTML = `<pre style="white-space: pre-wrap; font-family: inherit; margin: 0;">${tiltData.adjustmentHistory}</pre>`;
                } else {
                    document.getElementById('tiltAdjustmentCard').style.display = 'none';
                }
            }
        }

        function loadStrainData() {
            const strainData = getFromStorage(STORAGE_KEYS.STRAIN_DATA);
            
            if (strainData) {
                // í†µê³„ ì •ë³´
                document.getElementById('maxStrain').textContent = (strainData.maxStrain || '-') + ' Î¼Îµ';
                document.getElementById('avgStrain').textContent = (strainData.avgStrain || '-') + ' Î¼Îµ';
                document.getElementById('strainEvents').textContent = (strainData.eventCount || '-') + ' íšŒ';
                
                // ê°œë³„ í˜ì´ì§€ëŠ” measurements ë°°ì—´ì„ ì €ì¥í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ í…Œì´ë¸” ìƒëµ
                
                // ë¦¬í¬íŠ¸ ì´ë¯¸ì§€
                const reportImage = getFromStorage(STORAGE_KEYS.STRAIN_REPORT_IMAGE);
                if (reportImage) {
                    document.getElementById('strainReportImage').innerHTML = `<img src="${reportImage}" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;">`;
                } else {
                    document.getElementById('strainReportCard').style.display = 'none';
                }
                
                // ì „ì²´ ë³€í˜•ë¥  ê·¸ë˜í”„ ì´ë¯¸ì§€
                const graphImage = getFromStorage(STORAGE_KEYS.STRAIN_GRAPH_IMAGE);
                if (graphImage) {
                    document.getElementById('strainGraphImage').innerHTML = `<img src="${graphImage}" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;">`;
                } else {
                    document.getElementById('strainGraphCard').style.display = 'none';
                }
            }
        }

        function loadErrorData() {
            const errorData = getFromStorage(STORAGE_KEYS.FABRICATION_ERROR);
            const photos = getFromStorage(STORAGE_KEYS.PHOTOS);
            
            if (errorData && errorData.measurements && errorData.measurements.length > 0) {
                let html = '';
                const labels = ['íŒ¨ë„ ê¸¸ì´', 'íŒ¨ë„ í­', 'íŒ¨ë„ ë‘ê»˜'];
                
                errorData.measurements.forEach((m, i) => {
                    const design = m.design || 0;
                    const measured = m.measured || 0;
                    const error = m.error || 0;
                    
                    let tolerance = '';
                    let isPass = false;
                    
                    if (i === 0 || i === 1) {
                        // íŒ¨ë„ ê¸¸ì´/í­
                        const onePct = design * 0.01;
                        const tol = Math.min(onePct, 30);
                        tolerance = `Â±${tol.toFixed(1)}mm`;
                        isPass = Math.abs(error) <= tol;
                    } else {
                        // íŒ¨ë„ ë‘ê»˜
                        tolerance = '+10.0 ~ -5.0mm';
                        isPass = error >= -5 && error <= 10;
                    }
                    
                    html += `<tr>
                        <td>${labels[i]}</td>
                        <td>${design.toFixed(1)}</td>
                        <td>${measured.toFixed(1)}</td>
                        <td>${error.toFixed(1)}</td>
                        <td>${tolerance}</td>
                        <td><span class="badge ${isPass ? 'badge-success' : 'badge-danger'}">${isPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td>
                    </tr>`;
                });
                
                document.getElementById('errorTable').innerHTML = html;
            } else {
                document.getElementById('errorTable').innerHTML = '<tr><td colspan="6" style="text-align: center; color: #6b7280;">âš ï¸ ì œì‘ ì˜¤ì°¨ ì¸¡ì • ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            }
            
            // ë¶€ì¬ ì‚¬ì§„
            if (photos && (photos.errorPhoto1 || photos.errorPhoto2)) {
                let photoHTML = '';
                if (photos.errorPhoto1) photoHTML += `<img src="${photos.errorPhoto1}" alt="ë¶€ì¬ ì‚¬ì§„ 1">`;
                if (photos.errorPhoto2) photoHTML += `<img src="${photos.errorPhoto2}" alt="ë¶€ì¬ ì‚¬ì§„ 2">`;
                document.getElementById('errorPhotos').innerHTML = photoHTML;
            } else {
                document.getElementById('errorPhotosCard').style.display = 'none';
            }
        }

        function loadDashboard() {
            // ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘
            const surveyData = getFromStorage(STORAGE_KEYS.SURVEY_DATA);
            const accelData = getFromStorage(STORAGE_KEYS.ACCELERATION_DATA);
            const tiltData = getFromStorage(STORAGE_KEYS.TILT_DATA);
            const strainData = getFromStorage(STORAGE_KEYS.STRAIN_DATA);
            const errorData = getFromStorage(STORAGE_KEYS.FABRICATION_ERROR);
            
            let totalItems = 0;
            let passedItems = 0;
            let failedItems = 0;
            let detailHTML = '';
            const issues = [];
            
            // 1. ìš´ì†¡ê²°ê³¼ í‰ê°€ (5ê°œ í•­ëª©)
            if (surveyData) {
                const q1Pass = surveyData.q1 === 'ìˆ˜ë ¹';
                const q2Pass = surveyData.q2 === 'ì†ìƒì—†ìŒ' || surveyData.q2 === 'ì—†ìŒ';
                const q3Pass = surveyData.q3 === 'ì–‘í˜¸';
                const q4Pass = surveyData.q4 === 'ì •ìƒ' || surveyData.q4 === 'ì—†ìŒ';
                const q5Pass = surveyData.q5 === 'ì ì¹˜ë¨' || surveyData.q5 === 'ì ì¹˜ì™„ë£Œ';
                
                totalItems += 5;
                if (q1Pass) passedItems++; else { failedItems++; issues.push('âš ï¸ í’ˆì§ˆë³´ì¦ì„œ ë¯¸ìˆ˜ë ¹'); }
                if (q2Pass) passedItems++; else { failedItems++; issues.push('âš ï¸ ìŠ¬ë˜ë¸Œ ì†ìƒ/ê· ì—´ ë°œê²¬'); }
                if (q3Pass) passedItems++; else { failedItems++; issues.push('âš ï¸ ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°© ë¶ˆëŸ‰'); }
                if (q4Pass) passedItems++; else { failedItems++; issues.push('âš ï¸ ì™€ì´ì–´/ìŠ¬ë§ë²¨íŠ¸ ê²°í•¨'); }
                if (q5Pass) passedItems++; else { failedItems++; issues.push('âš ï¸ ìŠ¬ë˜ë¸Œ ë¯¸ì ì¹˜'); }
                
                detailHTML += `
                    <tr><td>í’ˆì§ˆë³´ì¦ì„œ ìˆ˜ë ¹</td><td>${surveyData.q1 || '-'}</td><td>ìˆ˜ë ¹ í•„ìˆ˜</td><td><span class="badge ${q1Pass ? 'badge-success' : 'badge-danger'}">${q1Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${q1Pass ? '-' : 'í’ˆì§ˆë³´ì¦ì„œ ë¯¸ìˆ˜ë ¹'}</td></tr>
                    <tr><td>ìŠ¬ë˜ë¸Œ ì†ìƒ/ê· ì—´</td><td>${surveyData.q2 || '-'}</td><td>ì†ìƒì—†ìŒ ë˜ëŠ” ì—†ìŒ</td><td><span class="badge ${q2Pass ? 'badge-success' : 'badge-danger'}">${q2Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${q2Pass ? '-' : 'ìŠ¬ë˜ë¸Œ ì†ìƒ/ê· ì—´ ë°œê²¬'}</td></tr>
                    <tr><td>ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°©ìƒíƒœ</td><td>${surveyData.q3 || '-'}</td><td>ì–‘í˜¸</td><td><span class="badge ${q3Pass ? 'badge-success' : 'badge-danger'}">${q3Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${q3Pass ? '-' : 'ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°© ë¶ˆëŸ‰'}</td></tr>
                    <tr><td>ì™€ì´ì–´/ìŠ¬ë§ë²¨íŠ¸ ê²°í•¨</td><td>${surveyData.q4 || '-'}</td><td>ì •ìƒ ë˜ëŠ” ì—†ìŒ</td><td><span class="badge ${q4Pass ? 'badge-success' : 'badge-danger'}">${q4Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${q4Pass ? '-' : 'ì™€ì´ì–´/ìŠ¬ë§ë²¨íŠ¸ ê²°í•¨ ë°œê²¬'}</td></tr>
                    <tr><td>ìŠ¬ë˜ë¸Œ ì ì¹˜</td><td>${surveyData.q5 || '-'}</td><td>ì ì¹˜ë¨ ë˜ëŠ” ì ì¹˜ì™„ë£Œ</td><td><span class="badge ${q5Pass ? 'badge-success' : 'badge-danger'}">${q5Pass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${q5Pass ? '-' : 'ìŠ¬ë˜ë¸Œ ë¯¸ì ì¹˜'}</td></tr>
                `;
            }
            
            // 2. ê°€ì†ë„
            if (accelData && accelData.maxAcceleration !== undefined) {
                totalItems++;
                const maxAccel = parseFloat(accelData.maxAcceleration) || 0;
                const accelPass = maxAccel <= 0.40;
                if (accelPass) passedItems++; else { failedItems++; issues.push(`âš ï¸ ê°€ì†ë„ ìœ„í—˜ (${maxAccel.toFixed(2)}g)`); }
                detailHTML += `<tr><td>ê°€ì†ë„ ìµœëŒ€ê°’</td><td>${maxAccel.toFixed(2)}g</td><td>0.40g ì´í•˜</td><td><span class="badge ${accelPass ? 'badge-success' : 'badge-danger'}">${accelPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${accelPass ? '-' : 'ìœ„í—˜ ê¸°ì¤€ ì´ˆê³¼'}</td></tr>`;
            }
            
            // 3. ê¸°ìš¸ê¸°
            if (tiltData && tiltData.maxTilt !== undefined) {
                totalItems++;
                const maxTilt = parseFloat(tiltData.maxTilt) || 0;
                const tiltPass = maxTilt <= 10.0;
                if (tiltPass) passedItems++; else { failedItems++; issues.push(`âš ï¸ ê¸°ìš¸ê¸° ìœ„í—˜ (${maxTilt.toFixed(1)}Â°)`); }
                detailHTML += `<tr><td>ê¸°ìš¸ê¸° ìµœëŒ€ê°’</td><td>${maxTilt.toFixed(1)}Â°</td><td>10.0Â° ì´í•˜</td><td><span class="badge ${tiltPass ? 'badge-success' : 'badge-danger'}">${tiltPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${tiltPass ? '-' : 'ìœ„í—˜ ê¸°ì¤€ ì´ˆê³¼'}</td></tr>`;
            }
            
            // 4. ë³€í˜•ë¥ 
            if (strainData && strainData.maxStrain !== undefined) {
                totalItems++;
                const maxStrain = Math.abs(parseFloat(strainData.maxStrain) || 0);
                const strainPass = maxStrain <= 130;
                if (strainPass) passedItems++; else { failedItems++; issues.push(`âš ï¸ ë³€í˜•ë¥  ìœ„í—˜ (${maxStrain.toFixed(0)}Î¼Îµ)`); }
                detailHTML += `<tr><td>ë³€í˜•ë¥  ìµœëŒ€ê°’</td><td>${maxStrain.toFixed(0)}Î¼Îµ</td><td>130Î¼Îµ ì´í•˜</td><td><span class="badge ${strainPass ? 'badge-success' : 'badge-danger'}">${strainPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${strainPass ? '-' : 'í—ˆìš© ê¸°ì¤€ ì´ˆê³¼'}</td></tr>`;
            }
            
            // 5. ì œì‘ ì˜¤ì°¨
            if (errorData && errorData.measurements && errorData.measurements.length > 0) {
                const labels = ['íŒ¨ë„ ê¸¸ì´', 'íŒ¨ë„ í­', 'íŒ¨ë„ ë‘ê»˜'];
                errorData.measurements.forEach((m, i) => {
                    totalItems++;
                    const design = m.design || 0;
                    const error = m.error || 0;
                    let isPass = false;
                    let toleranceDesc = '';
                    
                    if (i === 0 || i === 1) {
                        const tol = Math.min(design * 0.01, 30);
                        isPass = Math.abs(error) <= tol;
                        toleranceDesc = `Â±${tol.toFixed(1)}mm`;
                    } else {
                        isPass = error >= -5 && error <= 10;
                        toleranceDesc = '+10 ~ -5mm';
                    }
                    
                    if (isPass) passedItems++; else { failedItems++; issues.push(`âš ï¸ ${labels[i]} ì˜¤ì°¨ ì´ˆê³¼ (${error.toFixed(1)}mm)`); }
                    detailHTML += `<tr><td>${labels[i]}</td><td>${error.toFixed(1)}mm</td><td>${toleranceDesc}</td><td><span class="badge ${isPass ? 'badge-success' : 'badge-danger'}">${isPass ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}</span></td><td>${isPass ? '-' : 'í—ˆìš© ì˜¤ì°¨ ì´ˆê³¼'}</td></tr>`;
                });
            }
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            document.getElementById('totalItems').textContent = totalItems + 'ê°œ';
            document.getElementById('passedItems').textContent = passedItems + 'ê°œ';
            document.getElementById('failedItems').textContent = failedItems + 'ê°œ';
            
            // ì¢…í•© í‰ê°€
            const passRate = totalItems > 0 ? (passedItems / totalItems * 100) : 0;
            const overallCard = document.getElementById('overallCard');
            
            if (passRate >= 90) {
                overallCard.className = 'stat-card success';
                overallCard.querySelector('.stat-value').textContent = 'ìš°ìˆ˜';
                document.getElementById('finalJudgment').className = 'alert alert-success';
                document.getElementById('finalJudgment').innerHTML = '<strong>âœ… ëª¨ë“  í’ˆì§ˆ ê¸°ì¤€ì„ ë§Œì¡±í•©ë‹ˆë‹¤.</strong><br>ì‹œê³µì„ ì§„í–‰í•˜ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤.';
            } else if (passRate >= 70) {
                overallCard.className = 'stat-card';
                overallCard.querySelector('.stat-value').textContent = 'ì–‘í˜¸';
                document.getElementById('finalJudgment').className = 'alert alert-warning';
                document.getElementById('finalJudgment').innerHTML = '<strong>âš ï¸ ëŒ€ë¶€ë¶„ì˜ í’ˆì§ˆ ê¸°ì¤€ì„ ë§Œì¡±í•˜ë‚˜,</strong><br>ì¼ë¶€ í•­ëª©ì— ëŒ€í•œ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.';
            } else {
                overallCard.className = 'stat-card danger';
                overallCard.querySelector('.stat-value').textContent = 'ë¶ˆí•©ê²©';
                document.getElementById('finalJudgment').className = 'alert alert-danger';
                document.getElementById('finalJudgment').innerHTML = '<strong>âŒ í’ˆì§ˆ ê¸°ì¤€ ë¯¸ë‹¬ì…ë‹ˆë‹¤.</strong><br>ì¡°ì¹˜ í›„ ì¬ê²€ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.';
            }
            
            // ìƒì„¸ í…Œì´ë¸”
            if (detailHTML) {
                document.getElementById('detailTable').innerHTML = detailHTML;
            }
            
            // ì´ìŠˆ
            if (issues.length > 0) {
                document.getElementById('issuesContainer').innerHTML = '<ul style="margin: 0; padding-left: 1.5rem;">' + issues.map(i => `<li>${i}</li>`).join('') + '</ul>';
            }
            
            console.log('âœ… ì „ì²´ ë³´ê³ ì„œ ë¡œë“œ ì™„ë£Œ');
        }
    </script>
</body>
</html>
