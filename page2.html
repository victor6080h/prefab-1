<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ν’μ§κ΄€λ¦¬ μ‹μ¤ν… - ν’μ§κ΄€λ¦¬μ μ„¤λ¬Έ</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script defer src="assets/js/script.js"></script>
</head>
<body>
    <!-- ν—¤λ” -->
    <header class="header">
        <div class="container">
            <h1 class="header-title">Prefab ν’μ§κ΄€λ¦¬ μ‹μ¤ν…</h1>
            <p class="header-subtitle">ν’μ§κ΄€λ¦¬μ μ„¤λ¬Έμ΅°μ‚¬</p>
        </div>
    </header>

    <!-- νμ΄μ§€ λ„¤λΉ„κ²μ΄μ… -->
    <nav class="page-nav">
        <div class="container">
            <ul>
                <li><a href="index.html">1. μΆ…ν•© μ”μ•½</a></li>
                <li><a href="page2.html" class="active">2. ν’μ§κ΄€λ¦¬μ μ„¤λ¬Έ</a></li>
                <li><a href="page3.html">3. κ°€μ†λ„ λ°μ΄ν„°</a></li>
                <li><a href="page4.html">4. κΈ°μΈκΈ° λ°μ΄ν„°</a></li>
                <li><a href="page5.html">5. λ³€ν•λ¥  λ°μ΄ν„°</a></li>
                <li><a href="page6.html">6. λ¶€μ¬ μ μ‘ μ¤μ°¨</a></li>
                <li><a href="dashboard.html">7. μΆ…ν•© λ€μ‹λ³΄λ“</a></li>
            </ul>
        </div>
    </nav>

    <!-- λ©”μΈ μ»¨ν…μΈ  -->
    <main class="container">
        <!-- μ•λ‚΄ μ‚¬ν•­ -->
        <div class="alert alert-info">
            <strong>π“‹ μ„¤λ¬Έ μ•λ‚΄</strong>
            <p style="margin-top: 0.5rem;">
                Prefab λ¶€μ¬μ ν’μ§μ„ ν™•μΈν•κΈ° μ„ν• μ„¤λ¬Έμ…λ‹λ‹¤. κ° ν•­λ©μ— λ€ν•΄ μ •ν™•ν•κ² λ‹µλ³€ν•΄ μ£Όμ„Έμ”.
                λ¨λ“  ν•­λ©μ€ μλ™μΌλ΅ μ €μ¥λ©λ‹λ‹¤.
            </p>
        </div>

        <!-- μ„¤λ¬Έ νΌ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ν’μ§κ΄€λ¦¬ μ„¤λ¬Έ</h2>
                <p class="card-description">Prefab λ¶€μ¬μ μ„λ¥ λ° μ™Έκ΄€ ν’μ§μ„ ν™•μΈν•©λ‹λ‹¤</p>
            </div>
            <div class="card-body">
                <form id="surveyForm">
                    <!-- μ§λ¬Έ 1 -->
                    <fieldset>
                        <legend>1. ν’μ§λ³΄μ¦μ„λ¥Ό μλ Ήν•μ€λ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q1" value="μλ Ή" required>
                            μλ Ή
                        </label>
                        <label>
                            <input type="radio" name="q1" value="λ―Έμλ Ή">
                            λ―Έμλ Ή
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 2 -->
                    <fieldset>
                        <legend>2. μ‹ν—μ„±μ μ„κ°€ μ²¨λ¶€λμ–΄ μλ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q2" value="μ²¨λ¶€" required>
                            μ²¨λ¶€
                        </label>
                        <label>
                            <input type="radio" name="q2" value="λ―Έμ²¨λ¶€">
                            λ―Έμ²¨λ¶€
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 3 -->
                    <fieldset>
                        <legend>3. μ½ν¬λ¦¬νΈ κ°•λ„λ” μ„¤κ³„ κΈ°μ¤€μ„ λ§μ΅±ν•λ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q3" value="λ§μ΅±" required>
                            λ§μ΅±
                        </label>
                        <label>
                            <input type="radio" name="q3" value="λ¶λ§μ΅±">
                            λ¶λ§μ΅±
                        </label>
                        <label>
                            <input type="radio" name="q3" value="λ―Έν™•μΈ">
                            λ―Έν™•μΈ
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 4 -->
                    <fieldset>
                        <legend>4. μ² κ·Ό λ°°κ·Όμ€ μ„¤κ³„λ„λ©΄κ³Ό μΌμΉν•λ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q4" value="μΌμΉ" required>
                            μΌμΉ
                        </label>
                        <label>
                            <input type="radio" name="q4" value="λ¶μΌμΉ">
                            λ¶μΌμΉ
                        </label>
                        <label>
                            <input type="radio" name="q4" value="λ―Έν™•μΈ">
                            λ―Έν™•μΈ
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 5 -->
                    <fieldset>
                        <legend>5. λ¶€μ¬ ν‘λ©΄μ— κ· μ—΄μ΄ λ°κ²¬λμ—λ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q5" value="μ—†μ" required>
                            μ—†μ
                        </label>
                        <label>
                            <input type="radio" name="q5" value="λ―Έμ„Έκ· μ—΄">
                            λ―Έμ„Έκ· μ—΄ (0.3mm μ΄ν•)
                        </label>
                        <label>
                            <input type="radio" name="q5" value="μ£Όμ”κ· μ—΄">
                            μ£Όμ”κ· μ—΄ (0.3mm μ΄κ³Ό)
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 6 -->
                    <fieldset>
                        <legend>6. λ¶€μ¬ ν‘λ©΄μ λ§κ° μƒνƒλ” μ–‘νΈν•κ°€?</legend>
                        <label>
                            <input type="radio" name="q6" value="μ–‘νΈ" required>
                            μ–‘νΈ
                        </label>
                        <label>
                            <input type="radio" name="q6" value="λ³΄ν†µ">
                            λ³΄ν†µ
                        </label>
                        <label>
                            <input type="radio" name="q6" value="λ¶λ‰">
                            λ¶λ‰
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 7 -->
                    <fieldset>
                        <legend>7. μ–‘μƒ μƒνƒλ” μ μ ν•κ°€?</legend>
                        <label>
                            <input type="radio" name="q7" value="μ μ " required>
                            μ μ 
                        </label>
                        <label>
                            <input type="radio" name="q7" value="λ¶€μ μ ">
                            λ¶€μ μ 
                        </label>
                        <label>
                            <input type="radio" name="q7" value="λ―Έν™•μΈ">
                            λ―Έν™•μΈ
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 8 -->
                    <fieldset>
                        <legend>8. λ§¤μ… λ¶€ν’(μΈμ„νΈ, μ•µμ»¤ λ“±)μ€ μ •ν™•ν μ„¤μΉλμ—λ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q8" value="μ •ν™•" required>
                            μ •ν™•
                        </label>
                        <label>
                            <input type="radio" name="q8" value="λ¶€μ •ν™•">
                            λ¶€μ •ν™•
                        </label>
                        <label>
                            <input type="radio" name="q8" value="ν•΄λ‹Ήμ—†μ">
                            ν•΄λ‹Ήμ—†μ
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 9 -->
                    <fieldset>
                        <legend>9. λ¶€μ¬ μ‹λ³„ ν‘μ‹(λ§ν‚Ή)κ°€ λ…ν™•ν•κ°€?</legend>
                        <label>
                            <input type="radio" name="q9" value="λ…ν™•" required>
                            λ…ν™•
                        </label>
                        <label>
                            <input type="radio" name="q9" value="λ¶λ…ν™•">
                            λ¶λ…ν™•
                        </label>
                        <label>
                            <input type="radio" name="q9" value="μ—†μ">
                            μ—†μ
                        </label>
                    </fieldset>

                    <!-- μ§λ¬Έ 10 -->
                    <fieldset>
                        <legend>10. μ΄λ° λ° λ³΄κ΄€ μ¤‘ μ†μƒμ΄ λ°κ²¬λμ—λ”κ°€?</legend>
                        <label>
                            <input type="radio" name="q10" value="μ—†μ" required>
                            μ—†μ
                        </label>
                        <label>
                            <input type="radio" name="q10" value="κ²½λ―Έν•μ†μƒ">
                            κ²½λ―Έν• μ†μƒ
                        </label>
                        <label>
                            <input type="radio" name="q10" value="μ‹¬κ°ν•μ†μƒ">
                            μ‹¬κ°ν• μ†μƒ
                        </label>
                    </fieldset>

                    <!-- μ¶”κ°€ μκ²¬ -->
                    <fieldset>
                        <legend>μ¶”κ°€ μκ²¬ λ° νΉμ΄μ‚¬ν•­</legend>
                        <textarea name="comments" rows="5" 
                                  placeholder="λ°κ²¬λ λ¬Έμ μ μ΄λ‚ νΉμ΄μ‚¬ν•­μ„ κΈ°λ΅ν•μ„Έμ”..."
                                  style="width: 100%; resize: vertical;"></textarea>
                    </fieldset>
                </form>
            </div>
        </div>

        <!-- μ‚¬μ§„ μ²¨λ¶€ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ν„μ¥ μ‚¬μ§„</h2>
                <p class="card-description">λ¶€μ¬ μ „μ²΄ λ° νΉμ΄μ‚¬ν•­μ΄ μλ” λ¶€λ¶„μ μ‚¬μ§„μ„ μ²¨λ¶€ν•μ„Έμ”</p>
            </div>
            <div class="card-body">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                    <!-- μ‚¬μ§„ 1 -->
                    <div>
                        <h3 class="mb-2">λ¶€μ¬ μ „μ²΄ μ‚¬μ§„</h3>
                        <div class="photo-upload">
                            <img id="photo1Preview" style="display:none;">
                            <input type="file" accept="image/*" onchange="previewImage(this, 'photo1Preview')">
                            <span class="placeholder">π“· μ‚¬μ§„ μ—…λ΅λ“</span>
                        </div>
                    </div>

                    <!-- μ‚¬μ§„ 2 -->
                    <div>
                        <h3 class="mb-2">ν’μ§λ³΄μ¦μ„ μ‚¬μ§„</h3>
                        <div class="photo-upload">
                            <img id="photo2Preview" style="display:none;">
                            <input type="file" accept="image/*" onchange="previewImage(this, 'photo2Preview')">
                            <span class="placeholder">π“· μ‚¬μ§„ μ—…λ΅λ“</span>
                        </div>
                    </div>

                    <!-- μ‚¬μ§„ 3 -->
                    <div>
                        <h3 class="mb-2">νΉμ΄μ‚¬ν•­ μ‚¬μ§„ (μ„ νƒ)</h3>
                        <div class="photo-upload">
                            <img id="photo3Preview" style="display:none;">
                            <input type="file" accept="image/*" onchange="previewImage(this, 'photo3Preview')">
                            <span class="placeholder">π“· μ‚¬μ§„ μ—…λ΅λ“</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- μ„¤λ¬Έ κ²°κ³Ό μ”μ•½ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">μ„¤λ¬Έ κ²°κ³Ό μ”μ•½</h2>
            </div>
            <div class="card-body">
                <div id="surveyResult">
                    <p class="text-center" style="color: var(--text-secondary);">
                        μ„¤λ¬Έμ„ μ™„λ£ν•λ©΄ κ²°κ³Όκ°€ μ—¬κΈ°μ— ν‘μ‹λ©λ‹λ‹¤.
                    </p>
                </div>
                <div class="progress-bar mt-3">
                    <div class="progress-fill" id="surveyProgress" style="width: 0%;">0%</div>
                </div>
            </div>
        </div>

        <!-- λ„¤λΉ„κ²μ΄μ… λ²„νΌ -->
        <div class="nav-buttons">
            <a href="index.html" class="btn btn-secondary">β† μ΄μ „: μΆ…ν•© μ”μ•½</a>
            <button class="btn btn-success" onclick="saveSurvey()">π’Ύ μ €μ¥ν•κΈ°</button>
            <a href="page3.html" class="btn btn-primary">λ‹¤μ: κ°€μ†λ„ λ°μ΄ν„° β†’</a>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // νΌ λ°μ΄ν„° λ΅λ“
            loadFormData('surveyForm', STORAGE_KEYS.SURVEY_DATA);
            
            // μλ™ μ €μ¥ μ„¤μ •
            autoSaveForm('surveyForm', STORAGE_KEYS.SURVEY_DATA);
            
            // μ €μ¥λ μ΄λ―Έμ§€ λ΅λ“
            loadSavedImage('photo1Preview');
            loadSavedImage('photo2Preview');
            loadSavedImage('photo3Preview');
            
            // νΌ λ³€κ²½ μ‹ μ§„ν–‰λ¥  μ—…λ°μ΄νΈ
            document.getElementById('surveyForm').addEventListener('change', updateSurveyProgress);
            
            // μ΄κΈ° μ§„ν–‰λ¥  κ³„μ‚°
            updateSurveyProgress();
        });

        // μ„¤λ¬Έ μ§„ν–‰λ¥  μ—…λ°μ΄νΈ
        function updateSurveyProgress() {
            const form = document.getElementById('surveyForm');
            const totalQuestions = 10; // μ „μ²΄ μ§λ¬Έ μ
            let answeredQuestions = 0;

            // κ° μ§λ¬Έλ³„λ΅ λ‹µλ³€ μ—¬λ¶€ ν™•μΈ
            for (let i = 1; i <= totalQuestions; i++) {
                const question = form.querySelector(`input[name="q${i}"]:checked`);
                if (question) {
                    answeredQuestions++;
                }
            }

            // μ§„ν–‰λ¥  κ³„μ‚°
            const progress = Math.round((answeredQuestions / totalQuestions) * 100);
            const progressBar = document.getElementById('surveyProgress');
            progressBar.style.width = progress + '%';
            progressBar.textContent = progress + '%';

            // μ§„ν–‰λ¥ μ— λ”°λ¥Έ μƒ‰μƒ λ³€κ²½
            progressBar.className = 'progress-fill';
            if (progress === 100) {
                progressBar.classList.add('success');
                showSurveyResult();
            } else if (progress >= 50) {
                progressBar.classList.add('warning');
            }
        }

        // μ„¤λ¬Έ κ²°κ³Ό ν‘μ‹
        function showSurveyResult() {
            const form = document.getElementById('surveyForm');
            const formData = new FormData(form);
            
            let passCount = 0;
            let failCount = 0;
            let warningCount = 0;

            // κ° μ§λ¬Έμ λ‹µλ³€ ν‰κ°€
            const evaluations = {
                q1: { pass: ['μλ Ή'], fail: ['λ―Έμλ Ή'] },
                q2: { pass: ['μ²¨λ¶€'], fail: ['λ―Έμ²¨λ¶€'] },
                q3: { pass: ['λ§μ΅±'], fail: ['λ¶λ§μ΅±'], warning: ['λ―Έν™•μΈ'] },
                q4: { pass: ['μΌμΉ'], fail: ['λ¶μΌμΉ'], warning: ['λ―Έν™•μΈ'] },
                q5: { pass: ['μ—†μ'], warning: ['λ―Έμ„Έκ· μ—΄'], fail: ['μ£Όμ”κ· μ—΄'] },
                q6: { pass: ['μ–‘νΈ'], warning: ['λ³΄ν†µ'], fail: ['λ¶λ‰'] },
                q7: { pass: ['μ μ '], fail: ['λ¶€μ μ '], warning: ['λ―Έν™•μΈ'] },
                q8: { pass: ['μ •ν™•', 'ν•΄λ‹Ήμ—†μ'], fail: ['λ¶€μ •ν™•'] },
                q9: { pass: ['λ…ν™•'], warning: ['λ¶λ…ν™•'], fail: ['μ—†μ'] },
                q10: { pass: ['μ—†μ'], warning: ['κ²½λ―Έν•μ†μƒ'], fail: ['μ‹¬κ°ν•μ†μƒ'] }
            };

            for (let i = 1; i <= 10; i++) {
                const answer = formData.get(`q${i}`);
                const eval = evaluations[`q${i}`];
                
                if (eval.pass && eval.pass.includes(answer)) {
                    passCount++;
                } else if (eval.fail && eval.fail.includes(answer)) {
                    failCount++;
                } else if (eval.warning && eval.warning.includes(answer)) {
                    warningCount++;
                }
            }

            // κ²°κ³Ό HTML μƒμ„±
            let resultHTML = `
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1rem;">
                    <div class="stat-card success">
                        <div class="stat-label">μ ν•©</div>
                        <div class="stat-value">${passCount}</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-label">μ£Όμ</div>
                        <div class="stat-value">${warningCount}</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-label">λ¶€μ ν•©</div>
                        <div class="stat-value">${failCount}</div>
                    </div>
                </div>
            `;

            // μΆ…ν•© ν‰κ°€
            if (failCount === 0 && warningCount === 0) {
                resultHTML += `<div class="alert alert-success">
                    <strong>β… ν’μ§ μ ν•©</strong><br>
                    λ¨λ“  ν•­λ©μ΄ κΈ°μ¤€μ„ λ§μ΅±ν•©λ‹λ‹¤.
                </div>`;
            } else if (failCount === 0) {
                resultHTML += `<div class="alert alert-warning">
                    <strong>β οΈ μ£Όμ ν•„μ”</strong><br>
                    ${warningCount}κ° ν•­λ©μ—μ„ μ£Όμκ°€ ν•„μ”ν•©λ‹λ‹¤. ν™•μΈ ν›„ μ΅°μΉν•μ„Έμ”.
                </div>`;
            } else {
                resultHTML += `<div class="alert alert-danger">
                    <strong>β ν’μ§ λ¶€μ ν•©</strong><br>
                    ${failCount}κ° ν•­λ©μ΄ κΈ°μ¤€μ„ λ§μ΅±ν•μ§€ μ•μµλ‹λ‹¤. μ¦‰μ‹ μ΅°μΉκ°€ ν•„μ”ν•©λ‹λ‹¤.
                </div>`;
            }

            document.getElementById('surveyResult').innerHTML = resultHTML;
        }

        // μ„¤λ¬Έ μ €μ¥
        function saveSurvey() {
            const form = document.getElementById('surveyForm');
            
            // ν•„μ μ§λ¬Έ ν™•μΈ
            let allAnswered = true;
            for (let i = 1; i <= 10; i++) {
                const question = form.querySelector(`input[name="q${i}"]:checked`);
                if (!question) {
                    allAnswered = false;
                    break;
                }
            }

            if (!allAnswered) {
                alert('λ¨λ“  μ§λ¬Έμ— λ‹µλ³€ν•΄ μ£Όμ„Έμ”.');
                return;
            }

            // νΌ λ°μ΄ν„° μ €μ¥
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            saveToStorage(STORAGE_KEYS.SURVEY_DATA, data);
            
            alert('μ„¤λ¬Έ λ°μ΄ν„°κ°€ μ €μ¥λμ—μµλ‹λ‹¤!');
            updateSurveyProgress();
        }
    </script>
</body>
</html>
