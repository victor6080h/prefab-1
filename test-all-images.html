<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ì²´ ë³´ê³ ì„œ ì´ë¯¸ì§€ í†µí•© í…ŒìŠ¤íŠ¸</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f3f4f6;
        }
        h1 {
            color: #1f2937;
            border-bottom: 4px solid #3b82f6;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 2px solid #e5e7eb;
        }
        .card h2 {
            margin: 0 0 15px 0;
            color: #374151;
            font-size: 1.25rem;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }
        .status {
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.95rem;
        }
        .status.success { background: #d1fae5; color: #065f46; border-left: 4px solid #10b981; }
        .status.error { background: #fee2e2; color: #991b1b; border-left: 4px solid #ef4444; }
        .status.warning { background: #fef3c7; color: #78350f; border-left: 4px solid #f59e0b; }
        button {
            padding: 10px 20px;
            margin: 5px 5px 5px 0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-success { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-warning { background: #f59e0b; color: white; }
        .action-bar {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .summary-item {
            background: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .summary-item strong { display: block; color: #6b7280; font-size: 0.85rem; margin-bottom: 5px; }
        .summary-item span { font-size: 1.5rem; font-weight: bold; color: #1f2937; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ì „ì²´ ë³´ê³ ì„œ ì´ë¯¸ì§€ í†µí•© í…ŒìŠ¤íŠ¸</h1>

    <div class="action-bar">
        <h2 style="margin-top: 0;">âš¡ ë¹ ë¥¸ ì‘ì—…</h2>
        <button class="btn-success" onclick="saveAllTestData()">ğŸ’¾ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë°ì´í„° ì €ì¥</button>
        <button class="btn-primary" onclick="checkAllData()">ğŸ” ì „ì²´ ë°ì´í„° í™•ì¸</button>
        <button class="btn-warning" onclick="window.open('print-report.html', '_blank')">ğŸ“„ ì „ì²´ ë³´ê³ ì„œ ì—´ê¸°</button>
        <button class="btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì‚­ì œ</button>
        <button class="btn-primary" onclick="location.reload()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
    </div>

    <div class="summary" id="summary"></div>

    <div class="grid">
        <div class="card">
            <h2>ğŸ“Š ê°€ì†ë„ ë“±ê¸‰ í‰ê°€ ì´ë¯¸ì§€</h2>
            <div id="accelStatus"></div>
            <button class="btn-success" onclick="saveAccelData()">ì €ì¥</button>
            <button class="btn-primary" onclick="window.open('page3.html', '_blank')">í˜ì´ì§€ ì—´ê¸°</button>
        </div>

        <div class="card">
            <h2>ğŸ“ ê¸°ìš¸ê¸° ë“±ê¸‰ í‰ê°€ ì´ë¯¸ì§€</h2>
            <div id="tiltStatus"></div>
            <button class="btn-success" onclick="saveTiltData()">ì €ì¥</button>
            <button class="btn-primary" onclick="window.open('page4.html', '_blank')">í˜ì´ì§€ ì—´ê¸°</button>
        </div>

        <div class="card">
            <h2>ğŸ“ ë³€í˜•ë¥  ë“±ê¸‰ í‰ê°€ ì´ë¯¸ì§€</h2>
            <div id="strainStatus"></div>
            <button class="btn-success" onclick="saveStrainData()">ì €ì¥</button>
            <button class="btn-primary" onclick="window.open('page5.html', '_blank')">í˜ì´ì§€ ì—´ê¸°</button>
        </div>
    </div>

    <script>
        const STORAGE_KEYS = {
            ACCELERATION_DATA: 'qms_acceleration_data',
            TILT_DATA: 'qms_tilt_data',
            STRAIN_DATA: 'qms_strain_data'
        };

        function getFromStorage(key) {
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                return null;
            }
        }

        function saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
                return true;
            } catch (e) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + e.message);
                return false;
            }
        }

        function saveAccelData() {
            const testImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAFUlEQVR42mP8z8BQz0AEYBxVSF+FABJADveWkH6oAAAAAElFTkSuQmCC';
            const data = {
                maxAcceleration: 0.35,
                avgAcceleration: 0.25,
                eventCount: 5,
                accelReportImage: testImage
            };
            if (saveToStorage(STORAGE_KEYS.ACCELERATION_DATA, data)) {
                alert('âœ… ê°€ì†ë„ ë°ì´í„° ì €ì¥ ì™„ë£Œ!');
                checkAllData();
            }
        }

        function saveTiltData() {
            const testImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAFUlEQVR42mNk+M9Qz0AEYBxVSF+FABJADveWkH6oAAAAAElFTkSuQmCC';
            const data = {
                maxTilt: 8.5,
                avgTilt: 5.2,
                eventCount: 3,
                tiltReportImage: testImage
            };
            if (saveToStorage(STORAGE_KEYS.TILT_DATA, data)) {
                alert('âœ… ê¸°ìš¸ê¸° ë°ì´í„° ì €ì¥ ì™„ë£Œ!');
                checkAllData();
            }
        }

        function saveStrainData() {
            const testImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAUklEQVR42mNgQAL/GdAEMDEgC/j7+/9nYGD4z4AMMDAwMPz//x8ZYFNIUFxYWPg/AwMDMoeuEBkgKyQoxKaQoAKCCvEqxKsQrwK8CgkqBADdURcQj2hsuwAAAABJRU5ErkJggg==';
            const data = {
                maxStrain: 120,
                avgStrain: 75,
                eventCount: 2,
                strainReportImage: testImage
            };
            if (saveToStorage(STORAGE_KEYS.STRAIN_DATA, data)) {
                alert('âœ… ë³€í˜•ë¥  ë°ì´í„° ì €ì¥ ì™„ë£Œ!');
                checkAllData();
            }
        }

        function saveAllTestData() {
            saveAccelData();
            saveTiltData();
            saveStrainData();
        }

        function checkAllData() {
            const accelData = getFromStorage(STORAGE_KEYS.ACCELERATION_DATA);
            const tiltData = getFromStorage(STORAGE_KEYS.TILT_DATA);
            const strainData = getFromStorage(STORAGE_KEYS.STRAIN_DATA);

            // ê°€ì†ë„
            if (accelData?.accelReportImage) {
                document.getElementById('accelStatus').innerHTML = `
                    <div class="status success">âœ… ì´ë¯¸ì§€ ì €ì¥ë¨<br>í¬ê¸°: ${accelData.accelReportImage.length} bytes</div>
                `;
            } else {
                document.getElementById('accelStatus').innerHTML = `
                    <div class="status error">âŒ ì´ë¯¸ì§€ ì—†ìŒ</div>
                `;
            }

            // ê¸°ìš¸ê¸°
            if (tiltData?.tiltReportImage) {
                document.getElementById('tiltStatus').innerHTML = `
                    <div class="status success">âœ… ì´ë¯¸ì§€ ì €ì¥ë¨<br>í¬ê¸°: ${tiltData.tiltReportImage.length} bytes</div>
                `;
            } else {
                document.getElementById('tiltStatus').innerHTML = `
                    <div class="status error">âŒ ì´ë¯¸ì§€ ì—†ìŒ</div>
                `;
            }

            // ë³€í˜•ë¥ 
            if (strainData?.strainReportImage) {
                document.getElementById('strainStatus').innerHTML = `
                    <div class="status success">âœ… ì´ë¯¸ì§€ ì €ì¥ë¨<br>í¬ê¸°: ${strainData.strainReportImage.length} bytes</div>
                `;
            } else {
                document.getElementById('strainStatus').innerHTML = `
                    <div class="status error">âŒ ì´ë¯¸ì§€ ì—†ìŒ</div>
                `;
            }

            // ìš”ì•½
            const total = 3;
            const saved = (accelData?.accelReportImage ? 1 : 0) + 
                         (tiltData?.tiltReportImage ? 1 : 0) + 
                         (strainData?.strainReportImage ? 1 : 0);

            document.getElementById('summary').innerHTML = `
                <div class="summary-item">
                    <strong>ì „ì²´ ì´ë¯¸ì§€</strong>
                    <span>${total}ê°œ</span>
                </div>
                <div class="summary-item">
                    <strong>ì €ì¥ëœ ì´ë¯¸ì§€</strong>
                    <span style="color: #10b981;">${saved}ê°œ</span>
                </div>
                <div class="summary-item">
                    <strong>ëˆ„ë½ëœ ì´ë¯¸ì§€</strong>
                    <span style="color: #ef4444;">${total - saved}ê°œ</span>
                </div>
                <div class="summary-item">
                    <strong>ì™„ë£Œìœ¨</strong>
                    <span style="color: ${saved === total ? '#10b981' : '#f59e0b'};">${Math.round(saved/total*100)}%</span>
                </div>
            `;
        }

        function clearAllData() {
            if (confirm('ì •ë§ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem(STORAGE_KEYS.ACCELERATION_DATA);
                localStorage.removeItem(STORAGE_KEYS.TILT_DATA);
                localStorage.removeItem(STORAGE_KEYS.STRAIN_DATA);
                alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                checkAllData();
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í™•ì¸
        window.addEventListener('DOMContentLoaded', checkAllData);
    </script>
</body>
</html>
