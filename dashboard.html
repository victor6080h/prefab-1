<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í’ˆì§ˆê´€ë¦¬ ì‹œìŠ¤í…œ - ì¢…í•© ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script defer src="assets/js/script.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1 class="header-title">Prefab í’ˆì§ˆê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            <p class="header-subtitle">ì¢…í•© ëŒ€ì‹œë³´ë“œ</p>
        </div>
    </header>

    <nav class="page-nav">
        <div class="container">
            <button onclick="window.location.href='index.html'" style="float: right; background: #667eea; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                ğŸ“‹ ë³´ê³ ì„œ ëª©ë¡
            </button>
            <ul>
                <li><a href="report.html">1. ì¢…í•© ìš”ì•½</a></li>
                <li><a href="page2.html">2. ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸</a></li>
                <li><a href="page3.html">3. ê°€ì†ë„ ë°ì´í„°</a></li>
                <li><a href="page4.html">4. ê¸°ìš¸ê¸° ë°ì´í„°</a></li>
                <li><a href="page5.html">5. ë³€í˜•ë¥  ë°ì´í„°</a></li>
                <li><a href="page6.html">6. ë¶€ì¬ ì œì‘ ì˜¤ì°¨</a></li>
                <li><a href="dashboard.html" class="active">7. ì¢…í•© ëŒ€ì‹œë³´ë“œ</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <div class="alert alert-info">
            <strong>ğŸ“‹ ì¢…í•© ëŒ€ì‹œë³´ë“œ</strong>
            <p style="margin-top: 0.5rem;">
                ëª¨ë“  í’ˆì§ˆê´€ë¦¬ í•­ëª©ì˜ ê²°ê³¼ë¥¼ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                ê° í•­ëª©ì„ í´ë¦­í•˜ì—¬ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.
            </p>
        </div>

        <!-- í”„ë¡œì íŠ¸ ì •ë³´ ìš”ì•½ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">í”„ë¡œì íŠ¸ ì •ë³´</h2>
            </div>
            <div class="card-body">
                <div class="info-grid" id="projectSummary">
                    <div class="info-item">
                        <div class="info-label">ê³µì‚¬ëª…</div>
                        <div class="info-value" id="dashProjectName">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ì ê²€ì¼</div>
                        <div class="info-value" id="dashInspectionDate">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Prefab ì¢…ë¥˜</div>
                        <div class="info-value" id="dashPrefabType">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ì ê²€ì</div>
                        <div class="info-value" id="dashInspector">-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì¢…í•© í‰ê°€ ê²°ê³¼ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ì¢…í•© í’ˆì§ˆ í‰ê°€</h2>
            </div>
            <div class="card-body">
                <div class="stats-grid">
                    <div class="stat-card" id="surveyCard">
                        <div class="stat-label">ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸</div>
                        <div class="stat-value">ëŒ€ê¸°ì¤‘</div>
                        <button class="btn btn-primary mt-2" onclick="location.href='page2.html'" style="font-size: 0.875rem; padding: 0.5rem 1rem;">ìƒì„¸ë³´ê¸°</button>
                    </div>
                    <div class="stat-card" id="accelCard">
                        <div class="stat-label">ê°€ì†ë„ ê³„ì¸¡</div>
                        <div class="stat-value">ëŒ€ê¸°ì¤‘</div>
                        <button class="btn btn-primary mt-2" onclick="location.href='page3.html'" style="font-size: 0.875rem; padding: 0.5rem 1rem;">ìƒì„¸ë³´ê¸°</button>
                    </div>
                    <div class="stat-card" id="tiltCard">
                        <div class="stat-label">ê¸°ìš¸ê¸° ê³„ì¸¡</div>
                        <div class="stat-value">ëŒ€ê¸°ì¤‘</div>
                        <button class="btn btn-primary mt-2" onclick="location.href='page4.html'" style="font-size: 0.875rem; padding: 0.5rem 1rem;">ìƒì„¸ë³´ê¸°</button>
                    </div>
                    <div class="stat-card" id="strainCard">
                        <div class="stat-label">ë³€í˜•ë¥  ê³„ì¸¡</div>
                        <div class="stat-value">ëŒ€ê¸°ì¤‘</div>
                        <button class="btn btn-primary mt-2" onclick="location.href='page5.html'" style="font-size: 0.875rem; padding: 0.5rem 1rem;">ìƒì„¸ë³´ê¸°</button>
                    </div>
                    <div class="stat-card" id="errorCard">
                        <div class="stat-label">ì œì‘ ì˜¤ì°¨</div>
                        <div class="stat-value">ëŒ€ê¸°ì¤‘</div>
                        <button class="btn btn-primary mt-2" onclick="location.href='page6.html'" style="font-size: 0.875rem; padding: 0.5rem 1rem;">ìƒì„¸ë³´ê¸°</button>
                    </div>
                    <div class="stat-card" id="overallCard">
                        <div class="stat-label">ìµœì¢… íŒì •</div>
                        <div class="stat-value">í‰ê°€ì¤‘</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìƒì„¸ í‰ê°€ ê²°ê³¼ í…Œì´ë¸” -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ìƒì„¸ í‰ê°€ ê²°ê³¼</h2>
            </div>
            <div class="card-body">
                <table>
                    <thead>
                        <tr>
                            <th>í‰ê°€ í•­ëª©</th>
                            <th>ì¸¡ì • ê²°ê³¼</th>
                            <th>í—ˆìš© ê¸°ì¤€</th>
                            <th>íŒì •</th>
                            <th>ë¹„ê³ </th>
                        </tr>
                    </thead>
                    <tbody id="detailResultsTable">
                        <tr>
                            <td>í’ˆì§ˆë³´ì¦ì„œ ìˆ˜ë ¹</td>
                            <td id="surveyResult1">-</td>
                            <td>ìˆ˜ë ¹ í•„ìˆ˜</td>
                            <td id="surveyStatus1">-</td>
                            <td id="surveyNote1">-</td>
                        </tr>
                        <tr>
                            <td>ìŠ¬ë˜ë¸Œ ì†ìƒ/ê· ì—´</td>
                            <td id="surveyResult2">-</td>
                            <td>ì†ìƒì—†ìŒ ë˜ëŠ” ì—†ìŒ</td>
                            <td id="surveyStatus2">-</td>
                            <td id="surveyNote2">-</td>
                        </tr>
                        <tr>
                            <td>ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°©ìƒíƒœ</td>
                            <td id="surveyResult3">-</td>
                            <td>ì–‘í˜¸</td>
                            <td id="surveyStatus3">-</td>
                            <td id="surveyNote3">-</td>
                        </tr>
                        <tr>
                            <td>ì™€ì´ì–´/ìŠ¬ë§ë²¨íŠ¸ ê²°í•¨</td>
                            <td id="surveyResult4">-</td>
                            <td>ì •ìƒ ë˜ëŠ” ì—†ìŒ</td>
                            <td id="surveyStatus4">-</td>
                            <td id="surveyNote4">-</td>
                        </tr>
                        <tr>
                            <td>ìŠ¬ë˜ë¸Œ ì ì¹˜</td>
                            <td id="surveyResult5">-</td>
                            <td>ì ì¹˜ë¨ ë˜ëŠ” ì ì¹˜ì™„ë£Œ</td>
                            <td id="surveyStatus5">-</td>
                            <td id="surveyNote5">-</td>
                        </tr>
                        <tr>
                            <td>ê°€ì†ë„ ìµœëŒ€ê°’</td>
                            <td id="accelMaxResult">-</td>
                            <td>0.40g ì´í•˜<br><small>(ì •ìƒ: &lt;0.20g, ì£¼ì˜: 0.20~0.30g, ê²½ê³ : 0.30~0.40g, ìœ„í—˜: &gt;0.40g)</small></td>
                            <td id="accelStatus">-</td>
                            <td id="accelNote">-</td>
                        </tr>
                        <tr>
                            <td>ê¸°ìš¸ê¸° ìµœëŒ€ê°’</td>
                            <td id="tiltMaxResult">-</td>
                            <td>10Â° ì´í•˜<br><small>(ì •ìƒ: &lt;3Â°, ì£¼ì˜: 3~5Â°, ê²½ê³ : 5~10Â°, ìœ„í—˜: &gt;10Â°)</small></td>
                            <td id="tiltStatus">-</td>
                            <td id="tiltNote">-</td>
                        </tr>
                        <tr>
                            <td>ë³€í˜•ë¥  ìµœëŒ€ê°’</td>
                            <td id="strainMaxResult">-</td>
                            <td>130Î¼Îµ ì´í•˜<br><small>(ì •ìƒ: &lt;60Î¼Îµ, ì£¼ì˜: 60~80Î¼Îµ, ê²½ê³ : 80~130Î¼Îµ, ìœ„í—˜: &gt;130Î¼Îµ)</small></td>
                            <td id="strainStatus">-</td>
                            <td id="strainNote">-</td>
                        </tr>
                        <tr>
                            <td>ì œì‘ ì˜¤ì°¨</td>
                            <td id="errorMaxResult">-</td>
                            <td id="errorTolerance">KCS 24 11 25 : 2025<br><small>íŒ¨ë„ ê¸¸ì´/í­: Â±1% ë˜ëŠ” Â±30mm ì¤‘ ì‘ì€ ê°’<br>íŒ¨ë„ ë‘ê»˜: +10mm ~ -5mm</small></td>
                            <td id="errorStatus">-</td>
                            <td id="errorNote">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ì§„í–‰ë¥  í‘œì‹œ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">í’ˆì§ˆê´€ë¦¬ ì§„í–‰ë¥ </h2>
            </div>
            <div class="card-body">
                <div style="margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <span style="font-weight: 600;">ì „ì²´ ì§„í–‰ë¥ </span>
                        <span id="overallProgressText" style="font-weight: 700; font-size: 1.25rem;">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="overallProgress" style="width: 0%;">0%</div>
                    </div>
                </div>
                <div style="font-size: 0.875rem; color: var(--text-secondary);">
                    <p>ì™„ë£Œëœ í•­ëª©: <span id="completedCount" style="font-weight: 600; color: var(--success-color);">0</span> / 5</p>
                </div>
            </div>
        </div>

        <!-- ì£¼ìš” ì´ìŠˆ ë° ê¶Œê³ ì‚¬í•­ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ì£¼ìš” ì´ìŠˆ ë° ê¶Œê³ ì‚¬í•­</h2>
            </div>
            <div class="card-body">
                <div id="issuesContainer">
                    <p class="text-center" style="color: var(--text-secondary);">
                        ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ë©´ ì£¼ìš” ì´ìŠˆê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>

        <!-- ìµœì¢… íŒì • -->
        <div class="card" id="finalJudgmentCard">
            <div class="card-header">
                <h2 class="card-title">ìµœì¢… í’ˆì§ˆ íŒì •</h2>
            </div>
            <div class="card-body">
                <div id="finalJudgment" style="text-align: center; padding: 2rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">â³</div>
                    <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">í‰ê°€ ëŒ€ê¸°ì¤‘</h3>
                    <p style="color: var(--text-secondary);">
                        ëª¨ë“  í’ˆì§ˆê´€ë¦¬ í•­ëª©ì„ ì™„ë£Œí•˜ë©´ ìµœì¢… íŒì •ì´ í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>

        <!-- ë³´ê³ ì„œ ì¶œë ¥ -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ë³´ê³ ì„œ ê´€ë¦¬</h2>
            </div>
            <div class="card-body">
                <div class="alert alert-info mb-3">
                    <strong>ğŸ“„ ì „ì²´ ë³´ê³ ì„œ ì¸ì‡„ ì•ˆë‚´</strong>
                    <p style="margin-top: 0.5rem;">
                        ëª¨ë“  í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ì¸ì‡„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                        ì¸ì‡„ ì„¤ì •ì—ì„œ <strong>"ë°°ê²½ ê·¸ë˜í”½ ì¸ì‡„"</strong> ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´ ìƒ‰ìƒì´ ì¶œë ¥ë©ë‹ˆë‹¤.
                    </p>
                    <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                        <li>1. ì¢…í•© ìš”ì•½</li>
                        <li>2. ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸ (ì‚¬ì§„ í¬í•¨)</li>
                        <li>3. ê°€ì†ë„ ë°ì´í„° (ê·¸ë˜í”„ í¬í•¨)</li>
                        <li>4. ê¸°ìš¸ê¸° ë°ì´í„° (ê·¸ë˜í”„ í¬í•¨)</li>
                        <li>5. ë³€í˜•ë¥  ë°ì´í„° (ê·¸ë˜í”„ í¬í•¨)</li>
                        <li>6. ë¶€ì¬ ì œì‘ ì˜¤ì°¨ (ì‚¬ì§„, ê·¸ë˜í”„ í¬í•¨)</li>
                        <li>7. ì¢…í•© ëŒ€ì‹œë³´ë“œ (ì¢…í•© í‰ê°€ í¬í•¨)</li>
                    </ul>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <a href="print-report.html" class="btn btn-primary" style="text-decoration: none;">ğŸ–¨ï¸ ì „ì²´ ë³´ê³ ì„œ ì¸ì‡„ í˜ì´ì§€ë¡œ ì´ë™</a>
                    <button class="btn btn-success" onclick="exportData()">ğŸ“¥ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                    <button class="btn btn-warning" onclick="location.href='index.html'">ğŸ  ì²˜ìŒìœ¼ë¡œ</button>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <a href="page6.html" class="btn btn-secondary">â† ì´ì „: ë¶€ì¬ ì œì‘ ì˜¤ì°¨</a>
            <a href="index.html" class="btn btn-primary">ğŸ  ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì‹œì‘');
            loadDashboardData();
        });

        function loadDashboardData() {
            console.log('ğŸ“Š ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜ ì‹¤í–‰');
            
            // í”„ë¡œì íŠ¸ ì •ë³´ ë¡œë“œ
            const projectInfo = getFromStorage(STORAGE_KEYS.PROJECT_INFO);
            console.log('í”„ë¡œì íŠ¸ ì •ë³´:', projectInfo);
            if (projectInfo) {
                document.getElementById('dashProjectName').textContent = projectInfo.projectName || '-';
                document.getElementById('dashInspectionDate').textContent = projectInfo.inspectionDate || '-';
                document.getElementById('dashPrefabType').textContent = projectInfo.prefabType || '-';
                document.getElementById('dashInspector').textContent = projectInfo.inspector || '-';
            }

            let completedCount = 0;
            const issues = [];

            // ìš´ì†¡ê²°ê³¼ ë¦¬í¬íŠ¸ í‰ê°€ (print-report.htmlê³¼ ë™ì¼í•œ ë¡œì§)
            const surveyData = getFromStorage(STORAGE_KEYS.SURVEY_DATA);
            if (surveyData) {
                completedCount++;
                const surveyCard = document.getElementById('surveyCard');
                
                // ê° í•­ëª©ë³„ pass ì—¬ë¶€ íŒë‹¨
                const q1Pass = surveyData.q1 === 'ìˆ˜ë ¹';
                const q2Pass = surveyData.q2 === 'ì†ìƒì—†ìŒ' || surveyData.q2 === 'ì—†ìŒ';
                const q3Pass = surveyData.q3 === 'ì–‘í˜¸';
                const q4Pass = surveyData.q4 === 'ì •ìƒ' || surveyData.q4 === 'ì—†ìŒ';
                const q5Pass = surveyData.q5 === 'ì ì¹˜ë¨' || surveyData.q5 === 'ì ì¹˜ì™„ë£Œ';
                
                const allPass = q1Pass && q2Pass && q3Pass && q4Pass && q5Pass;
                
                // ê²°ê³¼ í‘œì‹œ
                document.getElementById('surveyResult1').textContent = surveyData.q1 || '-';
                document.getElementById('surveyResult2').textContent = surveyData.q2 || '-';
                document.getElementById('surveyResult3').textContent = surveyData.q3 || '-';
                document.getElementById('surveyResult4').textContent = surveyData.q4 || '-';
                document.getElementById('surveyResult5').textContent = surveyData.q5 || '-';
                
                // ê° í•­ëª© ê°œë³„ í‰ê°€
                document.getElementById('surveyStatus1').innerHTML = q1Pass ? 
                    '<span class="badge badge-success">í•©ê²©</span>' : 
                    '<span class="badge badge-danger">ë¶ˆí•©ê²©</span>';
                document.getElementById('surveyNote1').textContent = q1Pass ? '-' : 'í’ˆì§ˆë³´ì¦ì„œ ë¯¸ìˆ˜ë ¹';
                
                document.getElementById('surveyStatus2').innerHTML = q2Pass ? 
                    '<span class="badge badge-success">í•©ê²©</span>' : 
                    '<span class="badge badge-danger">ë¶ˆí•©ê²©</span>';
                document.getElementById('surveyNote2').textContent = q2Pass ? '-' : 'ìŠ¬ë˜ë¸Œì— ì†ìƒ ë˜ëŠ” ê· ì—´ ë°œê²¬';
                
                document.getElementById('surveyStatus3').innerHTML = q3Pass ? 
                    '<span class="badge badge-success">í•©ê²©</span>' : 
                    '<span class="badge badge-danger">ë¶ˆí•©ê²©</span>';
                document.getElementById('surveyNote3').textContent = q3Pass ? '-' : 'ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°© ë¶ˆëŸ‰';
                
                document.getElementById('surveyStatus4').innerHTML = q4Pass ? 
                    '<span class="badge badge-success">í•©ê²©</span>' : 
                    '<span class="badge badge-danger">ë¶ˆí•©ê²©</span>';
                document.getElementById('surveyNote4').textContent = q4Pass ? '-' : 'ì™€ì´ì–´ ë˜ëŠ” ìŠ¬ë§ë²¨íŠ¸ì— ê²°í•¨ ë°œê²¬';
                
                document.getElementById('surveyStatus5').innerHTML = q5Pass ? 
                    '<span class="badge badge-success">í•©ê²©</span>' : 
                    '<span class="badge badge-danger">ë¶ˆí•©ê²©</span>';
                document.getElementById('surveyNote5').textContent = q5Pass ? '-' : 'ìŠ¬ë˜ë¸Œ ë¯¸ì ì¹˜';
                
                // ì „ì²´ í‰ê°€
                if (allPass) {
                    surveyCard.className = 'stat-card success';
                    surveyCard.querySelector('.stat-value').textContent = 'í•©ê²©';
                } else {
                    surveyCard.className = 'stat-card danger';
                    surveyCard.querySelector('.stat-value').textContent = 'ë¶ˆí•©ê²©';
                    
                    // ë¶ˆí•©ê²© í•­ëª© ì´ìŠˆ ì¶”ê°€
                    if (!q1Pass) issues.push('âš ï¸ í’ˆì§ˆë³´ì¦ì„œ ë¯¸ìˆ˜ë ¹');
                    if (!q2Pass) issues.push('âš ï¸ ìŠ¬ë˜ë¸Œ ì†ìƒ/ê· ì—´ ë°œê²¬');
                    if (!q3Pass) issues.push('âš ï¸ ìŠ¤í€ì§€ ì¬ë£Œ ë¶€ì°© ë¶ˆëŸ‰');
                    if (!q4Pass) issues.push('âš ï¸ ì™€ì´ì–´/ìŠ¬ë§ë²¨íŠ¸ ê²°í•¨');
                    if (!q5Pass) issues.push('âš ï¸ ìŠ¬ë˜ë¸Œ ë¯¸ì ì¹˜');
                }
            }

            // ê°€ì†ë„ í‰ê°€
            const accelData = getFromStorage(STORAGE_KEYS.ACCELERATION_DATA);
            if (accelData && accelData.maxAcceleration !== undefined) {
                completedCount++;
                const accelCard = document.getElementById('accelCard');
                const maxAccel = parseFloat(accelData.maxAcceleration) || 0;
                
                document.getElementById('accelMaxResult').textContent = maxAccel.toFixed(2) + ' g';
                
                // KCS ê¸°ì¤€: 0.40g ì´í•˜
                if (maxAccel <= 0.40) {
                    accelCard.className = 'stat-card success';
                    accelCard.querySelector('.stat-value').textContent = 'ì •ìƒ';
                    document.getElementById('accelStatus').innerHTML = '<span class="badge badge-success">ì •ìƒ</span>';
                    if (maxAccel < 0.20) {
                        document.getElementById('accelNote').textContent = 'ì •ìƒ (0.20g ë¯¸ë§Œ)';
                    } else if (maxAccel < 0.30) {
                        document.getElementById('accelNote').textContent = 'ì£¼ì˜ (0.20~0.30g)';
                    } else if (maxAccel < 0.40) {
                        document.getElementById('accelNote').textContent = 'ê²½ê³  (0.30~0.40g)';
                    } else {
                        document.getElementById('accelNote').textContent = 'ì •ìƒ ë²”ìœ„';
                    }
                } else {
                    accelCard.className = 'stat-card danger';
                    accelCard.querySelector('.stat-value').textContent = 'ìœ„í—˜';
                    document.getElementById('accelStatus').innerHTML = '<span class="badge badge-danger">ìœ„í—˜</span>';
                    document.getElementById('accelNote').textContent = 'ìœ„í—˜ (0.40g ì´ˆê³¼)';
                    issues.push(`ê°€ì†ë„ ìµœëŒ€ê°’(${maxAccel.toFixed(2)}g)ì´ í—ˆìš© ë²”ìœ„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.`);
                }
            }

            // ê¸°ìš¸ê¸° í‰ê°€
            const tiltData = getFromStorage(STORAGE_KEYS.TILT_DATA);
            if (tiltData && tiltData.maxTilt !== undefined) {
                completedCount++;
                const tiltCard = document.getElementById('tiltCard');
                const maxTilt = parseFloat(tiltData.maxTilt) || 0;
                
                document.getElementById('tiltMaxResult').textContent = maxTilt.toFixed(1) + 'Â°';
                
                // KCS ê¸°ì¤€: 10Â° ì´í•˜
                if (maxTilt <= 10.0) {
                    tiltCard.className = 'stat-card success';
                    tiltCard.querySelector('.stat-value').textContent = 'ì •ìƒ';
                    document.getElementById('tiltStatus').innerHTML = '<span class="badge badge-success">ì •ìƒ</span>';
                    if (maxTilt < 3.0) {
                        document.getElementById('tiltNote').textContent = 'ì •ìƒ (3Â° ë¯¸ë§Œ)';
                    } else if (maxTilt < 5.0) {
                        document.getElementById('tiltNote').textContent = 'ì£¼ì˜ (3~5Â°)';
                    } else if (maxTilt < 10.0) {
                        document.getElementById('tiltNote').textContent = 'ê²½ê³  (5~10Â°)';
                    } else {
                        document.getElementById('tiltNote').textContent = 'ì •ìƒ ë²”ìœ„';
                    }
                } else {
                    tiltCard.className = 'stat-card danger';
                    tiltCard.querySelector('.stat-value').textContent = 'ìœ„í—˜';
                    document.getElementById('tiltStatus').innerHTML = '<span class="badge badge-danger">ìœ„í—˜</span>';
                    document.getElementById('tiltNote').textContent = 'ìœ„í—˜ (10Â° ì´ˆê³¼)';
                    issues.push(`ê¸°ìš¸ê¸° ìµœëŒ€ê°’(${maxTilt.toFixed(1)}Â°)ì´ í—ˆìš© ë²”ìœ„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.`);
                }
            }

            // ë³€í˜•ë¥  í‰ê°€
            const strainData = getFromStorage(STORAGE_KEYS.STRAIN_DATA);
            if (strainData && strainData.maxStrain !== undefined) {
                completedCount++;
                const strainCard = document.getElementById('strainCard');
                const maxStrain = parseFloat(strainData.maxStrain) || 0;
                
                document.getElementById('strainMaxResult').textContent = maxStrain.toFixed(0) + ' Î¼Îµ';
                
                // KCS ê¸°ì¤€: 130Î¼Îµ ì´í•˜
                if (maxStrain <= 130) {
                    strainCard.className = 'stat-card success';
                    strainCard.querySelector('.stat-value').textContent = 'ì •ìƒ';
                    document.getElementById('strainStatus').innerHTML = '<span class="badge badge-success">ì •ìƒ</span>';
                    if (maxStrain < 60) {
                        document.getElementById('strainNote').textContent = 'ì •ìƒ (60Î¼Îµ ë¯¸ë§Œ)';
                    } else if (maxStrain < 80) {
                        document.getElementById('strainNote').textContent = 'ì£¼ì˜ (60~80Î¼Îµ)';
                    } else if (maxStrain < 130) {
                        document.getElementById('strainNote').textContent = 'ê²½ê³  (80~130Î¼Îµ)';
                    } else {
                        document.getElementById('strainNote').textContent = 'ì •ìƒ ë²”ìœ„';
                    }
                } else {
                    strainCard.className = 'stat-card danger';
                    strainCard.querySelector('.stat-value').textContent = 'ìœ„í—˜';
                    document.getElementById('strainStatus').innerHTML = '<span class="badge badge-danger">ìœ„í—˜</span>';
                    document.getElementById('strainNote').textContent = 'ìœ„í—˜ (130Î¼Îµ ì´ˆê³¼)';
                    issues.push(`ë³€í˜•ë¥  ìµœëŒ€ê°’(${maxStrain.toFixed(0)}Î¼Îµ)ì´ í—ˆìš© ë²”ìœ„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.`);
                }
            }

            // ì œì‘ ì˜¤ì°¨ í‰ê°€
            const errorData = getFromStorage(STORAGE_KEYS.FABRICATION_ERROR);
            if (errorData && errorData.measurements) {
                completedCount++;
                const errorCard = document.getElementById('errorCard');
                
                // KCS ê¸°ì¤€ í—ˆìš©ì˜¤ì°¨ ê³„ì‚° í•¨ìˆ˜
                function getAllowableTolerance(index, design) {
                    if (index === 0) {
                        // íŒ¨ë„ ê¸¸ì´: Â±1% ë˜ëŠ” Â±30mm ì¤‘ ì‘ì€ ê°’
                        const onePct = design * 0.01;
                        return Math.min(onePct, 30);
                    } else if (index === 1) {
                        // íŒ¨ë„ í­: Â±1% ë˜ëŠ” Â±30mm ì¤‘ ì‘ì€ ê°’
                        const onePct = design * 0.01;
                        return Math.min(onePct, 30);
                    } else if (index === 2) {
                        // íŒ¨ë„ ë‘ê»˜: +10mm ~ -5mm (ë¹„ëŒ€ì¹­)
                        return { upper: 10, lower: 5 };
                    }
                    return 5; // ê¸°ë³¸ê°’
                }
                
                // ê° í•­ëª©ë³„ í—ˆìš©ì˜¤ì°¨ ì´ˆê³¼ ì—¬ë¶€ í™•ì¸
                let hasExceeded = false;
                const labels = ['íŒ¨ë„ ê¸¸ì´', 'íŒ¨ë„ í­', 'íŒ¨ë„ ë‘ê»˜'];
                let resultDetails = [];
                let exceededItems = [];
                
                errorData.measurements.forEach((m, index) => {
                    const design = parseFloat(m.design) || 0;
                    const measured = parseFloat(m.measured) || 0;
                    const error = parseFloat(m.error) || 0;
                    
                    if (measured > 0) {
                        const tolerance = getAllowableTolerance(index, design);
                        let isExceeded = false;
                        let toleranceText = '';
                        
                        if (index === 2) {
                            // íŒ¨ë„ ë‘ê»˜ëŠ” ë¹„ëŒ€ì¹­ í—ˆìš©ì˜¤ì°¨
                            toleranceText = `+${tolerance.upper}/-${tolerance.lower}mm`;
                            if (error > tolerance.upper || error < -tolerance.lower) {
                                isExceeded = true;
                            }
                        } else {
                            // íŒ¨ë„ ê¸¸ì´/í­ì€ ëŒ€ì¹­ í—ˆìš©ì˜¤ì°¨
                            toleranceText = `Â±${tolerance.toFixed(1)}mm`;
                            if (Math.abs(error) > tolerance) {
                                isExceeded = true;
                            }
                        }
                        
                        resultDetails.push({
                            label: labels[index],
                            error: error,
                            tolerance: toleranceText,
                            exceeded: isExceeded
                        });
                        
                        if (isExceeded) {
                            hasExceeded = true;
                            exceededItems.push(`${labels[index]} ${error > 0 ? '+' : ''}${error.toFixed(1)}mm (í—ˆìš©: ${toleranceText})`);
                        }
                    }
                });
                
                // ê²°ê³¼ í‘œì‹œ - ê° í•­ëª©ë³„ ìƒì„¸ ì •ë³´
                let resultText = '';
                if (resultDetails.length > 0) {
                    resultText = resultDetails.map(item => {
                        const errorSign = item.error > 0 ? '+' : '';
                        const status = item.exceeded ? 'âš ï¸' : 'âœ“';
                        return `${status} ${item.label}: ${errorSign}${item.error.toFixed(1)}mm (í—ˆìš©: ${item.tolerance})`;
                    }).join('<br>');
                } else {
                    resultText = '-';
                }
                
                document.getElementById('errorMaxResult').innerHTML = resultText;
                document.getElementById('errorTolerance').innerHTML = 'KCS ê¸°ì¤€<br>(í•­ëª©ë³„ ìƒì´)';
                
                if (!hasExceeded) {
                    errorCard.className = 'stat-card success';
                    errorCard.querySelector('.stat-value').textContent = 'ì í•©';
                    document.getElementById('errorStatus').innerHTML = '<span class="badge badge-success">ì í•©</span>';
                    document.getElementById('errorNote').textContent = 'ëª¨ë“  í•­ëª© ì •ìƒ';
                } else {
                    errorCard.className = 'stat-card danger';
                    errorCard.querySelector('.stat-value').textContent = 'ë¶€ì í•©';
                    document.getElementById('errorStatus').innerHTML = '<span class="badge badge-danger">ì´ˆê³¼</span>';
                    document.getElementById('errorNote').textContent = `${exceededItems.length}ê°œ í•­ëª© ì´ˆê³¼`;
                    exceededItems.forEach(item => {
                        issues.push(`ì œì‘ ì˜¤ì°¨: ${item}`);
                    });
                }
            }

            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            const progress = (completedCount / 5) * 100;
            document.getElementById('overallProgress').style.width = progress + '%';
            document.getElementById('overallProgress').textContent = Math.round(progress) + '%';
            document.getElementById('overallProgressText').textContent = Math.round(progress) + '%';
            document.getElementById('completedCount').textContent = completedCount;

            if (progress === 100) {
                document.getElementById('overallProgress').className = 'progress-fill success';
            } else if (progress >= 50) {
                document.getElementById('overallProgress').className = 'progress-fill warning';
            }

            // ì´ìŠˆ í‘œì‹œ
            const issuesContainer = document.getElementById('issuesContainer');
            if (issues.length > 0) {
                let issuesHTML = '<div class="alert alert-warning"><strong>âš ï¸ ë°œê²¬ëœ ì´ìŠˆ:</strong><ul style="margin-top: 0.5rem; padding-left: 1.5rem;">';
                issues.forEach(issue => {
                    issuesHTML += `<li>${issue}</li>`;
                });
                issuesHTML += '</ul></div>';
                issuesContainer.innerHTML = issuesHTML;
            } else if (completedCount === 5) {
                issuesContainer.innerHTML = '<div class="alert alert-success"><strong>âœ… ì´ìŠˆ ì—†ìŒ</strong><br>ëª¨ë“  í’ˆì§ˆê´€ë¦¬ í•­ëª©ì´ ê¸°ì¤€ì„ ë§Œì¡±í•©ë‹ˆë‹¤.</div>';
            }

            // ìµœì¢… íŒì •
            if (completedCount === 5) {
                const finalJudgment = document.getElementById('finalJudgment');
                const overallCard = document.getElementById('overallCard');
                
                if (issues.length === 0) {
                    overallCard.className = 'stat-card success';
                    overallCard.querySelector('.stat-value').textContent = 'í•©ê²©';
                    finalJudgment.innerHTML = `
                        <div style="font-size: 5rem; margin-bottom: 1rem; color: var(--success-color);">âœ…</div>
                        <h3 style="font-size: 2rem; margin-bottom: 1rem; color: var(--success-color);">í’ˆì§ˆ ì í•©</h3>
                        <p style="font-size: 1.125rem; color: var(--text-primary);">
                            ëª¨ë“  í’ˆì§ˆê´€ë¦¬ í•­ëª©ì´ ê¸°ì¤€ì„ ë§Œì¡±í•©ë‹ˆë‹¤.<br>
                            í•´ë‹¹ Prefab ë¶€ì¬ëŠ” ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
                        </p>
                    `;
                    document.getElementById('finalJudgmentCard').className = 'card';
                    document.getElementById('finalJudgmentCard').style.borderLeft = '8px solid var(--success-color)';
                } else {
                    overallCard.className = 'stat-card danger';
                    overallCard.querySelector('.stat-value').textContent = 'ë¶€ì í•©';
                    finalJudgment.innerHTML = `
                        <div style="font-size: 5rem; margin-bottom: 1rem; color: var(--danger-color);">âŒ</div>
                        <h3 style="font-size: 2rem; margin-bottom: 1rem; color: var(--danger-color);">í’ˆì§ˆ ë¶€ì í•©</h3>
                        <p style="font-size: 1.125rem; color: var(--text-primary);">
                            ${issues.length}ê°œì˜ í’ˆì§ˆ ì´ìŠˆê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                            ì¡°ì¹˜ í›„ ì¬ê²€ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.
                        </p>
                    `;
                    document.getElementById('finalJudgmentCard').className = 'card';
                    document.getElementById('finalJudgmentCard').style.borderLeft = '8px solid var(--danger-color)';
                }
            }
        }
        
        // ì¸ì‡„ í•¨ìˆ˜
        function printDashboard() {
            // ì¸ì‡„ ì „ í™•ì¸ ë©”ì‹œì§€
            const printConfirm = confirm(
                'ğŸ“„ ì „ì²´ ë³´ê³ ì„œë¥¼ ì¸ì‡„í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n' +
                'ì¸ì‡„ íŒ:\n' +
                '1. ì¸ì‡„ ì„¤ì •ì—ì„œ "ë°°ê²½ ê·¸ë˜í”½" ì˜µì…˜ì„ í™œì„±í™”í•˜ì„¸ìš”\n' +
                '2. ìš©ì§€ ë°©í–¥: ì„¸ë¡œ (Portrait)\n' +
                '3. ìš©ì§€ í¬ê¸°: A4\n' +
                '4. ì—¬ë°±: ë³´í†µ\n\n' +
                'ëª¨ë“  ë°ì´í„°, ê·¸ë˜í”„, ì´ë¯¸ì§€ê°€ í¬í•¨ë©ë‹ˆë‹¤.'
            );
            
            if (printConfirm) {
                // ì¸ì‡„ ì „ í˜ì´ì§€ ì œëª© ë³€ê²½
                const originalTitle = document.title;
                const projectInfo = getFromStorage(STORAGE_KEYS.PROJECT_INFO);
                if (projectInfo && projectInfo.projectName) {
                    document.title = `í’ˆì§ˆê´€ë¦¬ë³´ê³ ì„œ_${projectInfo.projectName}_${getCurrentDate()}`;
                }
                
                // ì¸ì‡„ ì‹¤í–‰
                window.print();
                
                // ì œëª© ë³µì›
                setTimeout(() => {
                    document.title = originalTitle;
                }, 100);
            }
        }
    </script>
</body>
</html>
